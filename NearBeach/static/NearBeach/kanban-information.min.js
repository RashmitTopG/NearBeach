"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[1616],{3257:(e,a,t)=>{t.r(a),t.d(a,{default:()=>Ol});var l=t(6252),s=t(3577);const o={class:"kanban-header"},n={key:0,class:"btn-group kanban-menu"},d=(0,l._)("button",{class:"btn btn-secondary btn-sm dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Kanban Menu ",-1),i={class:"dropdown-menu"},r={class:"dropdown-item",href:"#"},c={key:0,class:"dropdown-divider"},u={key:0,class:"dropdown-divider"},m=["href"],b={key:1,style:{height:"31px",width:"100%"}},p={class:"modal fade",id:"addUserModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},h={class:"modal-dialog modal-lg"},_={class:"modal-content"},v={class:"modal-header"},k=(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"addUserCloseButton"},[(0,l._)("span",{"aria-hidden":"true"})],-1),g={class:"modal-body"},C={key:0,class:"row"},y=(0,l._)("div",{class:"col-md-4"},[(0,l._)("strong",null,"Add Users"),(0,l._)("p",{class:"text-instructions"}," Use the following multiple select to select which users you want to add to this kanban card. "),(0,l._)("p",{class:"text-instructions"}," Please note: A user's group has to be added to the kanban card before the user can be added. ")],-1),f={class:"col-md-8"},w={key:1,class:"row"},L=(0,l._)("div",{class:"col-md-6"},[(0,l._)("strong",null,"Sorry - no results"),(0,l._)("p",{class:"text-instructions"}," This could be because "),(0,l._)("ul",{class:"text-instructions"},[(0,l._)("li",null,"There are no more users left to add"),(0,l._)("li",null," The user you are after is in a group not current added to this kanban card ")])],-1),D={class:"col-md-6 no-search"},I=["src"],M={class:"modal-footer"},S=(0,l._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),U=["disabled"];var R=t(6542),$=t(2001),x=t(3138),N=t(989),T=t(5808);const A={name:"AddUserToCard",components:{Icon:R.JO,NSelect:$.Z},mixins:[T.Z],computed:{...(0,N.Se)({cardId:"getCardId",potentialUserList:"getPotentialUserList",rootUrl:"getRootUrl",staticURL:"getStaticUrl",userLevel:"getUserLevel"})},data:()=>({userFixList:[],userModel:[]}),watch:{potentialUserList(e){void 0!==e&&(this.userFixList=e.map((e=>({value:e.id,label:`${e.username}: ${e.first_name} ${e.last_name}`}))))}},methods:{addUser(){const e=new FormData;this.userModel.forEach((a=>{e.append("user_list",a)})),this.axios.post(`${this.rootUrl}object_data/kanban_card/${this.cardId}/add_user/`,e).then((e=>{document.getElementById("addUserCloseButton").click(),this.userModel=[],this.$store.commit("updateGroupsAndUsers",{objectGroupList:e.data.object_group_list,objectUserList:e.data.object_user_list,potentialGroupList:e.data.potential_group_list,potentialUserList:e.data.potential_user_list}),new x.u_(document.getElementById("cardInformationModal")).show()})).catch((e=>{this.$store.dispatch("newToast",{header:"Error adding user to kanban card",message:`Sorry, we could not add the user to the kanban card. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))}}};var E=t(3744);const q=(0,E.Z)(A,[["render",function(e,a,t,s,o,n){const d=(0,l.up)("Icon"),i=(0,l.up)("n-select");return(0,l.wg)(),(0,l.iD)("div",p,[(0,l._)("div",h,[(0,l._)("div",_,[(0,l._)("div",v,[(0,l._)("h2",null,[(0,l.Wm)(d,{icon:e.icons.userIcon},null,8,["icon"]),(0,l.Uk)(" Add User To Card ")]),k]),(0,l._)("div",g,[o.userFixList.length>0?((0,l.wg)(),(0,l.iD)("div",C,[y,(0,l._)("div",f,[(0,l.Wm)(i,{options:o.userFixList,value:o.userModel,"onUpdate:value":a[0]||(a[0]=e=>o.userModel=e),multiple:""},null,8,["options","value"])])])):((0,l.wg)(),(0,l.iD)("div",w,[L,(0,l._)("div",D,[(0,l._)("img",{src:`${e.staticURL}NearBeach/images/placeholder/questions.svg`,alt:"Sorry - there are no results"},null,8,I)])]))]),(0,l._)("div",M,[S,(0,l._)("button",{type:"button",class:"btn btn-primary",disabled:0===o.userModel.length,onClick:a[1]||(a[1]=(...e)=>n.addUser&&n.addUser(...e))}," Add User(s) ",8,U)])])])])}]]),j={class:"modal fade",id:"archiveCardsModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},B={class:"modal-dialog"},W={class:"modal-content"},P={class:"modal-header"},K=(0,l._)("h5",{class:"modal-title",id:"exampleModalLabel"}," Are you sure? ",-1),O=(0,l._)("div",{class:"modal-body"}," Are you sure you want to archive the cards? This can not be undone. ",-1),Z={class:"modal-footer"},F={name:"ArchiveCards",data:()=>({archiveCardsModal:{}}),computed:{...(0,N.Se)({allCards:"getCards",archiveDestination:"getArchiveDestination",archiveDestinationString:"getArchiveDestinationString",rootUrl:"getRootUrl"})},watch:{archiveDestinationString(e){void 0!==e&&(this.archiveCardsModal=new x.u_("#archiveCardsModal"),this.archiveCardsModal.show())}},methods:{archiveCards(){let e=this.archiveDestination.column,a=this.archiveDestination.level;const t=new FormData;this.allCards.filter((t=>parseInt(t.fields.kanban_column)===e&&parseInt(t.fields.kanban_level)===a)).forEach((e=>{t.append("kanban_card_id",e.pk)})),this.$store.commit({type:"archiveCards",column:e,level:a}),this.archiveCardsModal.hide(),this.$store.commit({type:"updateArchiveDestination",column:"",level:""}),this.axios.post(`${this.rootUrl}kanban_information/archive_kanban_cards/`,t).catch((e=>{}))},closeModal(){this.archiveCardsModal.hide(),this.$store.commit({type:"updateArchiveDestination",column:"",level:""})}}},V=(0,E.Z)(F,[["render",function(e,a,t,s,o,n){return(0,l.wg)(),(0,l.iD)("div",j,[(0,l._)("div",B,[(0,l._)("div",W,[(0,l._)("div",P,[K,(0,l._)("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:a[0]||(a[0]=(...e)=>n.closeModal&&n.closeModal(...e))})]),O,(0,l._)("div",Z,[(0,l._)("button",{type:"button",class:"btn btn-secondary",onClick:a[1]||(a[1]=(...e)=>n.closeModal&&n.closeModal(...e))}," No "),(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:a[2]||(a[2]=(...e)=>n.archiveCards&&n.archiveCards(...e))}," Yes ")])])])])}]]),z={class:"modal fade",id:"blockedNotesModal",tabindex:"-1","aria-labelledby":"blockedNotesModal","aria-hidden":"true"},H={class:"modal-dialog modal-lg modal-fullscreen-lg-down"},Y={class:"modal-content"},G=(0,l._)("div",{class:"modal-header"},[(0,l._)("h2",null,"Blocked Card Notes"),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"blockedNotesModalButton"},[(0,l._)("span",{"aria-hidden":"true"})])],-1),J={class:"modal-body"},Q={class:"row"},X=(0,l._)("div",{class:"col-md-4"},[(0,l._)("strong",null,"Blocked Card Notes"),(0,l._)("p",{class:"text-instructions"}," Please write a reason why this particular card is blocked at the moment. ")],-1),ee={class:"col-md-8"},ae={class:"modal-footer"},te=["disabled"];var le=t(7267);const se={name:"BlockedNotesModal",components:{editor:le.Z},props:{},data:()=>({noteModal:""}),computed:{...(0,N.Se)({cardId:"getCardId",contentCss:"getContentCss",rootUrl:"getRootUrl",skin:"getSkin"})},methods:{addNote(){const e=new FormData;e.set("note",this.noteModal),this.axios.post(`${this.rootUrl}object_data/kanban_card/${this.cardId}/add_notes/`,e).then((()=>{this.closeModal()}))},closeModal(){this.noteModal="",document.getElementById("blockedNotesModalButton").click()}}},oe=(0,E.Z)(se,[["render",function(e,a,t,s,o,n){const d=(0,l.up)("editor");return(0,l.wg)(),(0,l.iD)("div",z,[(0,l._)("div",H,[(0,l._)("div",Y,[G,(0,l._)("div",J,[(0,l._)("div",Q,[X,(0,l._)("div",ee,[(0,l.Wm)(d,{init:{file_picker_types:"image",height:250,menubar:!1,plugins:["lists","image","codesample","table"],toolbar:"undo redo | blocks | bold italic strikethrough underline backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | table image codesample",skin:`${this.skin}`,content_css:`${this.contentCss}`},modelValue:o.noteModal,"onUpdate:modelValue":a[0]||(a[0]=e=>o.noteModal=e)},null,8,["init","modelValue"])])])]),(0,l._)("div",ae,[(0,l._)("button",{class:"btn btn-secondary",onClick:a[1]||(a[1]=(...e)=>n.closeModal&&n.closeModal(...e))}," Close "),(0,l._)("button",{class:"btn btn-primary save-changes",onClick:a[2]||(a[2]=(...e)=>n.addNote&&n.addNote(...e)),disabled:""===o.noteModal}," Add Note ",8,te)])])])])}]]),ne={class:"kanban-header-row"},de={class:"kanban-header-row kanban-sticky-row",style:{display:"none"}},ie={class:"kanban-level-div"},re=["onClick"],ce={name:"KanbanBoard",components:{KanbanRow:t(676).Z},props:{kanbanBoardResults:{type:Array,default:()=>[]},newCardInfo:{type:Array,default:()=>[]}},computed:{...(0,N.Se)({columnResults:"getColumnResults",levelCardCount:"getLevelCardCount",levelResults:"getLevelResults"})},mixins:[T.Z],data:()=>({}),created(){window.addEventListener("resize",this.resizeProcedure),window.addEventListener("scroll",this.scrollProcedure)},unmounted(){window.removeEventListener("resize",this.resizeProcedure),window.removeEventListener("scroll",this.scrollProcedure)},methods:{doubleClickedCard(e){this.$emit("double_clicked_card",e)},expandLevel(e){this.$store.dispatch("updateLevelCollapse",{level_id:e})},getExpandClass(e){return this.$store.getters.getLevelCollapseStatus(e)?"kanban-expand collapsed":"kanban-expand expanded"},resizeProcedure(){const e=2*(this.columnResults.length-1),a=400*this.columnResults.length+e,t=document.getElementsByClassName("kanban-container")[0];if(void 0===t)return;const l=t.clientWidth;if(a<l){const e=document.getElementsByClassName("kanban-level-div");Array.from(e).forEach((e=>{e.style=`max-width: ${a}px;`}))}else{const e=t.scrollWidth;let a=document.getElementsByClassName("kanban-level-div");Array.from(a).forEach((a=>{a.style=`width: ${e}px;`}))}},scrollProcedure(){const e=document.getElementsByClassName("kanban-sticky-row")[0],a=document.getElementsByClassName("kanban-container")[0];e.scrollLeft=a.scrollLeft;const t=document.getElementById("kanban_container").scrollTop;e.style.display=t<90?"none":""}},mounted(){this.$nextTick((()=>{this.resizeProcedure()})),this.$store.commit({type:"updateKanbanStatus",kanbanStatus:this.kanbanBoardResults[0].fields.kanban_board_status})}},ue=(0,E.Z)(ce,[["render",function(e,a,t,o,n,d){const i=(0,l.up)("kanban-row");return(0,l.wg)(),(0,l.iD)("div",{id:"kanban_container",class:"kanban-container",onScroll:a[1]||(a[1]=(...e)=>d.scrollProcedure&&d.scrollProcedure(...e))},[(0,l.kq)(" Render out the header "),(0,l._)("div",ne,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.columnResults,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"kanban-column-header",key:e.pk},(0,s.toDisplayString)(e.fields.kanban_column_name),1)))),128))]),(0,l.kq)(" Render out the STICKY header "),(0,l._)("div",de,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.columnResults,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"kanban-column-header",key:e.pk},(0,s.toDisplayString)(e.fields.kanban_column_name),1)))),128))]),(0,l.kq)(" Render each row "),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.levelResults,(o=>((0,l.wg)(),(0,l.iD)("div",{key:o.pk},[(0,l.kq)(" CREATE THE LEVEL HEADER "),(0,l._)("div",ie,[(0,l._)("span",{class:(0,s.normalizeClass)(d.getExpandClass(o.pk)),onClick:e=>d.expandLevel(o.pk)},null,10,re),(0,l._)("span",null,(0,s.toDisplayString)(o.fields.kanban_level_name)+" - ["+(0,s.toDisplayString)(e.levelCardCount(o.pk))+"] ",1)]),(0,l.kq)(" RENDER THE CELLS "),(0,l.Wm)(i,{"level-id":o.pk,"new-card-info":t.newCardInfo,onDouble_clicked_card:a[0]||(a[0]=e=>d.doubleClickedCard(e))},null,8,["level-id","new-card-info"])])))),128))],32)}]]);var me=t(9963);const be={class:"modal fade",id:"addKanbanCardModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"addKanbanCardModalLabel","aria-hidden":"true"},pe={class:"modal-dialog modal-xl modal-fullscreen-xl-down"},he={class:"modal-content"},_e={class:"modal-header"},ve=(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"addKanbanCardCloseButton"},null,-1),ke={class:"modal-body"},ge={class:"row"},Ce=(0,l._)("div",{class:"col-md-4"},[(0,l._)("strong",null,"Please note"),(0,l._)("p",{class:"text-instructions"}," The card names can not be the same as something that already exists on the board. ")],-1),ye={class:"col-md-8"},fe={key:0,class:"error"},we=(0,l._)("hr",null,null,-1),Le={class:"row"},De=(0,l._)("div",{class:"col-md-4"},[(0,l._)("strong",null,"Card Priority"),(0,l._)("p",{class:"text-instructions"}," Please select the apprioriate card priority. ")],-1),Ie={class:"col-md-8"},Me=(0,l._)("label",null,"Card Priority",-1),Se=(0,l._)("hr",null,null,-1),Ue={class:"row"},Re=(0,l._)("div",{class:"col-md-4"},[(0,l._)("strong",null,"Card Description"),(0,l._)("p",{class:"text-instructions"},' Fill out a detailed description for the card, then click on the "Update Card" button to update the card. ')],-1),$e={class:"col-md-8"},xe={key:0},Ne={key:1,class:"row"},Te=(0,l._)("div",{class:"col-md-4"},[(0,l._)("strong",null,"Card Location"),(0,l._)("p",{class:"text-instructions"}," Select the appropriate location for this card. ")],-1),Ae={class:"col-md-8"},Ee={class:"row"},qe={class:"col-md-6 mt-4"},je=(0,l._)("label",null,"Card Column",-1),Be={class:"col-md-6 mt-4"},We=(0,l._)("label",null,"Card Level",-1),Pe={class:"modal-footer"},Ke=(0,l._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),Oe=["disabled"];var Ze=t(2299);const Fe={name:"NewKanbanCard",components:{editor:le.Z,Icon:R.JO,NSelect:$.Z},props:{columnResults:{type:Array,default:()=>[]},kanbanCardResults:{type:Array,default:()=>[]},levelResults:{type:Array,default:()=>[]},kanbanBoardResults:{type:Array,default:()=>[]}},mixins:[T.Z,Ze.Z],data:()=>({disableAddButton:!0,kanbanCardDescriptionModel:"",kanbanCardTextModel:"",kanbanCardPriorityModal:2,listPriority:[{label:"Highest",value:0},{label:"High",value:1},{label:"Normal",value:2},{label:"Low",value:3},{label:"Lowest",value:4}],localColumnId:0,localLevelId:0}),computed:{...(0,N.Se)({contentCss:"getContentCss",listColumns:"getListColumns",listLevels:"getListLevels",newCardLocation:"getNewCardLocation",rootUrl:"getRootUrl",skin:"getSkin"})},methods:{addKanbanCard(){this.disableAddButton=!0,this.$store.dispatch("newToast",{header:"Creating new card",message:"Please wait as we create the new card",extra_classes:"bg-warning",delay:0,unique_type:"new_card"});const e=new FormData;e.set("kanban_card_text",this.kanbanCardTextModel),e.set("kanban_card_description",this.kanbanCardDescriptionModel),e.set("kanban_level",this.localLevelId),e.set("kanban_column",this.localColumnId),e.set("kanban_card_priority",this.kanbanCardPriorityModal),this.axios.post(`${this.rootUrl}kanban_information/${this.kanbanBoardResults[0].pk}/new_card/`,e).then((e=>{this.$emit("new_card",e.data),this.kanbanCardTextModel="",this.kanbanCardDescriptionModel="",document.getElementById("addKanbanCardCloseButton").click(),this.$store.dispatch("newToast",{header:"Card created successfully",message:"Card created successfully",extra_classes:"bg-success",unique_type:"new_card"})})).catch((e=>{this.$store.dispatch("newToast",{header:"Error creating card",message:`Error creating card: Error -> ${e}`,extra_classes:"bg-danger",delay:0,unique_type:"new_card"})}))}},watch:{kanbanCardTextModel(){this.disableAddButton=!1,0===this.kanbanCardTextModel.length&&(this.disableAddButton=!0),this.kanbanCardResults.filter((e=>e.fields.kanban_card_text===this.kanbanCardTextModel)).length>0&&(this.disableAddButton=!0),0!==this.columnResults.length&&0!==this.levelResults.length||(this.disableAddButton=!0)},newCardLocation:{handler(e){this.localColumnId=e.columnId,this.localLevelId=e.levelId},deep:!0,immediate:!0}}},Ve=(0,E.Z)(Fe,[["render",function(e,a,t,s,o,n){const d=(0,l.up)("Icon"),i=(0,l.up)("n-select"),r=(0,l.up)("editor");return(0,l.wg)(),(0,l.iD)("div",be,[(0,l._)("div",pe,[(0,l._)("div",he,[(0,l._)("div",_e,[(0,l._)("h2",null,[(0,l.Wm)(d,{icon:e.icons.cardChecklist},null,8,["icon"]),(0,l.Uk)(" Add Kanban Card Wizard ")]),ve]),(0,l._)("div",ke,[(0,l._)("div",ge,[Ce,(0,l._)("div",ye,[(0,l._)("label",null,[(0,l.Uk)(" Kanban Card Text "),o.disableAddButton?((0,l.wg)(),(0,l.iD)("span",fe," Please supply a unique card name ")):(0,l.kq)("v-if",!0)]),(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>o.kanbanCardTextModel=e),onKeydown:a[1]||(a[1]=(0,me.withKeys)(((...e)=>n.addKanbanCard&&n.addKanbanCard(...e)),["enter"])),class:"form-control"},null,544),[[me.vModelText,o.kanbanCardTextModel]])])]),we,(0,l.kq)(" CARD PRIORITY "),(0,l._)("div",Le,[De,(0,l._)("div",Ie,[Me,(0,l.Wm)(i,{options:o.listPriority,value:o.kanbanCardPriorityModal,"onUpdate:value":a[2]||(a[2]=e=>o.kanbanCardPriorityModal=e)},null,8,["options","value"])])]),Se,(0,l.kq)(" CARD DESCRIPTION "),(0,l._)("div",Ue,[Re,(0,l._)("div",$e,[(0,l.Wm)(r,{init:{file_picker_types:"image",height:300,images_upload_handler:e.uploadImage,menubar:!1,paste_data_images:!0,plugins:["lists","image","codesample","table"],toolbar:"undo redo | blocks | bold italic strikethrough underline backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | table image codesample",skin:`${this.skin}`,content_css:`${this.contentCss}`},modelValue:o.kanbanCardDescriptionModel,"onUpdate:modelValue":a[3]||(a[3]=e=>o.kanbanCardDescriptionModel=e)},null,8,["init","modelValue"])])]),(0,l.kq)(" CARD LOCATION "),e.newCardLocation.userCanSelectLocation?((0,l.wg)(),(0,l.iD)("hr",xe)):(0,l.kq)("v-if",!0),e.newCardLocation.userCanSelectLocation?((0,l.wg)(),(0,l.iD)("div",Ne,[Te,(0,l._)("div",Ae,[(0,l._)("div",Ee,[(0,l._)("div",qe,[je,(0,l.Wm)(i,{options:e.listColumns,label:"column",value:o.localColumnId,"onUpdate:value":a[4]||(a[4]=e=>o.localColumnId=e)},null,8,["options","value"])]),(0,l._)("div",Be,[We,(0,l.Wm)(i,{options:e.listLevels,label:"level",value:o.localLevelId,"onUpdate:value":a[5]||(a[5]=e=>o.localLevelId=e)},null,8,["options","value"])])])])])):(0,l.kq)("v-if",!0)]),(0,l._)("div",Pe,[Ke,(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:a[6]||(a[6]=(...e)=>n.addKanbanCard&&n.addKanbanCard(...e)),disabled:o.disableAddButton}," Add Card ",8,Oe)])])])])}]]),ze={class:"modal fade",id:"cardInformationModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},He={class:"modal-dialog modal-xl modal-fullscreen-xl-down"},Ye={class:"modal-content"},Ge={class:"modal-header"},Je=(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"cardInformationModalCloseButton"},[(0,l._)("span",{"aria-hidden":"true"})],-1),Qe=(0,l._)("br",null,null,-1),Xe={class:"modal-body"},ea=(0,l._)("ul",{id:"card_information_tabs",class:"nav nav-tabs",role:"tablist"},[(0,l._)("li",{class:"nav-item",role:"presentation"},[(0,l._)("button",{class:"nav-link active",id:"details-tab","data-bs-toggle":"tab","data-bs-target":"#card_details",type:"button",role:"tab","aria-controls":"home","aria-selected":"true"}," Details ")]),(0,l._)("li",{class:"nav-item",role:"presentation"},[(0,l._)("button",{class:"nav-link",id:"description-tab","data-bs-toggle":"tab","data-bs-target":"#card_description",type:"button",role:"tab","aria-controls":"profile","aria-selected":"false"}," Description ")]),(0,l._)("li",{class:"nav-item",role:"presentation"},[(0,l._)("button",{class:"nav-link",id:"notes-tab","data-bs-toggle":"tab","data-bs-target":"#card_notes",type:"button",role:"tab","aria-controls":"contact","aria-selected":"false"}," Notes ")]),(0,l._)("li",{class:"nav-item",role:"presentation"},[(0,l._)("button",{class:"nav-link",id:"users-tab","data-bs-toggle":"tab","data-bs-target":"#user_permissions",type:"button",role:"tab","aria-controls":"contact","aria-selected":"false"}," Users ")]),(0,l._)("li",{class:"nav-item",role:"presentation"},[(0,l._)("button",{class:"nav-link",id:"downloads-tab","data-bs-toggle":"tab","data-bs-target":"#downloads",type:"button",role:"tab","aria-controls":"contact","aria-selected":"false"}," Downloads ")]),(0,l._)("li",{class:"nav-item",role:"presentation"},[(0,l._)("button",{class:"nav-link",id:"public-link-tab","data-bs-toggle":"tab","data-bs-target":"#public-links",type:"button",role:"tab","aria-controls":"contact","aria-selected":"false"}," Public Links ")])],-1),aa=(0,l._)("hr",null,null,-1),ta={class:"tab-content",id:"myTabContent"},la={class:"tab-pane fade show active",id:"card_details",role:"tabpanel","aria-labelledby":"details-tab"},sa={class:"tab-pane fade",id:"card_description",role:"tabpanel","aria-labelledby":"description-tab"},oa={class:"tab-pane fade",id:"card_notes",role:"tabpanel","aria-labelledby":"notes-tab"},na={class:"tab-pane fade",id:"user_permissions",role:"tabpanel","aria-labelledby":"user-tab"},da={class:"tab-pane fade",id:"downloads",role:"tabpanel","aria-labelledby":"user-tab"},ia={class:"tab-pane fade",id:"public-links",role:"tabpanel","aria-labelledby":"user-tab"},ra={key:0,class:"row link-to-object"},ca=(0,l._)("strong",null,"Object Link: ",-1),ua=["href"],ma={key:1},ba={class:"row"},pa=(0,l._)("div",{class:"col-md-4"},[(0,l._)("strong",null,"Card Title"),(0,l._)("p",{class:"text-instructions"},' Write an appropriate name for the kanban card. To update click on the "Update" button. ')],-1),ha={class:"col-md-8"},_a=(0,l._)("label",null,"Card Title",-1),va=["disabled"],ka=(0,l._)("hr",null,null,-1),ga={class:"row"},Ca=(0,l._)("div",{class:"col-md-4"},[(0,l._)("strong",null,"Card Priority"),(0,l._)("p",{class:"text-instructions"}," Define what the priority of the card is. ")],-1),ya={class:"col-md-4"},fa=(0,l._)("label",null,"Card Priority",-1),wa=(0,l._)("hr",null,null,-1),La={class:"row"},Da=(0,l._)("div",{class:"col-md-4"},[(0,l._)("strong",null,"Card Location"),(0,l._)("p",{class:"text-instructions"}," Select the appropriate location for this card. ")],-1),Ia={class:"col-md-8"},Ma={class:"row"},Sa={class:"col-md-6 mt-4"},Ua=(0,l._)("label",null,"Card Column",-1),Ra={class:"col-md-6 mt-4"},$a=(0,l._)("label",null,"Card Level",-1),xa={key:2},Na={key:3,class:"row"},Ta={class:"col-md-12 card-detail--buttons"},Aa={name:"CardDetails",components:{NSelect:$.Z},data:()=>({listPriority:[{label:"Highest",value:0},{label:"High",value:1},{label:"Normal",value:2},{label:"Low",value:3},{label:"Lowest",value:4}],tempModel:""}),computed:{...(0,N.Se)({cardId:"getCardId",cardLink:"getCardLink",kanbanStatus:"getKanbanStatus",listColumns:"getListColumns",listLevels:"getListLevels",userLevel:"getUserLevel"}),cardColumn:{get(){return this.$store.state.card.cardColumn},set(e){this.$store.commit({type:"updateValue",field:"cardColumn",value:e})}},cardLevel:{get(){return this.$store.state.card.cardLevel},set(e){this.$store.commit({type:"updateValue",field:"cardLevel",value:e})}},cardPriority:{get(){return this.$store.state.card.cardPriority},set(e){this.$store.commit({type:"updateValue",field:"cardPriority",value:e})}},cardTitle:{get(){return this.$store.state.card.cardTitle},set(e){this.$store.commit({type:"updateValue",field:"cardTitle",value:e})}}},methods:{archiveCard(){document.getElementById("cardInformationModalCloseButton").click(),new x.u_("#confirmCardArchiveModal").show()},closeModal(){document.getElementById("cardInformationModalCloseButton").click()},async differentDestination(e,a){const t=this.$store.getters.getCardsOrder(this.cardColumn,this.cardLevel).length,l={to:{dataset:{column:this.cardColumn,level:this.cardLevel}},from:{dataset:{column:a.fields.kanban_column,level:a.fields.kanban_level}},item:{dataset:{cardId:this.cardId,cardPriority:this.cardPriority}},newIndex:t};await this.$store.dispatch("kanbanCardMoved",{event:l});const s=this.$store.getters.getCardsOrder(this.cardColumn,this.cardLevel),o=this.$store.getters.getCardsOrder(a.fields.kanban_column,a.fields.kanban_level).filter((e=>parseInt(e.pk)!==parseInt(this.cardId)));this.$emit("update_card",{close_modal:e,new_destination:s,old_destination:o})},sameDestination(e){this.$store.commit({type:"updateKanbanCard",card_id:this.cardId,kanban_card_text:this.cardTitle,kanban_card_priority:this.cardPriority}),this.$emit("update_card",{close_modal:e})},updateCard(e){const a=this.$store.getters.getCard(this.cardId),t=parseInt(this.cardColumn)===parseInt(a.fields.kanban_column),l=parseInt(this.cardLevel)===parseInt(a.fields.kanban_level);t&&l?this.sameDestination(e):this.differentDestination(e,a)}}},Ea=(0,E.Z)(Aa,[["render",function(e,a,t,o,n,d){const i=(0,l.up)("n-select");return(0,l.wg)(),(0,l.iD)("div",null,[void 0!==e.cardLink.id&&null!==e.cardLink.id?((0,l.wg)(),(0,l.iD)("div",ra,[ca,(0,l._)("a",{href:e.cardLink.hyperlink,target:"_blank",rel:"noopener noreferrer"},(0,s.toDisplayString)(e.cardLink.type)+" - "+(0,s.toDisplayString)(e.cardLink.id),9,ua)])):(0,l.kq)("v-if",!0),void 0!==e.cardLink.id&&null!==e.cardLink.id?((0,l.wg)(),(0,l.iD)("hr",ma)):(0,l.kq)("v-if",!0),(0,l.kq)(" Card Text "),(0,l._)("div",ba,[pa,(0,l._)("div",ha,[_a,(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>d.cardTitle=e),class:"form-control",disabled:e.userLevel<=1},null,8,va),[[me.vModelText,d.cardTitle]])])]),ka,(0,l._)("div",ga,[Ca,(0,l._)("div",ya,[fa,(0,l.Wm)(i,{options:n.listPriority,value:d.cardPriority,"onUpdate:value":a[1]||(a[1]=e=>d.cardPriority=e),disabled:"Closed"===e.kanbanStatus||e.userLevel<=1},null,8,["options","value","disabled"])])]),wa,(0,l.kq)(" CARD LOCATION "),(0,l._)("div",La,[Da,(0,l._)("div",Ia,[(0,l._)("div",Ma,[(0,l._)("div",Sa,[Ua,(0,l.Wm)(i,{options:e.listColumns,label:"column",value:d.cardColumn,"onUpdate:value":a[2]||(a[2]=e=>d.cardColumn=e),disabled:"Closed"===e.kanbanStatus||e.userLevel<=1},null,8,["options","value","disabled"])]),(0,l._)("div",Ra,[$a,(0,l.Wm)(i,{options:e.listLevels,label:"level",value:d.cardLevel,"onUpdate:value":a[3]||(a[3]=e=>d.cardLevel=e),disabled:"Closed"===e.kanbanStatus||e.userLevel<=1},null,8,["options","value","disabled"])])])])]),e.userLevel>1?((0,l.wg)(),(0,l.iD)("hr",xa)):(0,l.kq)("v-if",!0),e.userLevel>1?((0,l.wg)(),(0,l.iD)("div",Na,[(0,l._)("div",Ta,[(0,l._)("button",{class:"btn btn-warning",onClick:a[4]||(a[4]=(...e)=>d.closeModal&&d.closeModal(...e))}," Close & Discard Changes "),"Closed"!==e.kanbanStatus?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"btn btn-danger archive-card",onClick:a[5]||(a[5]=(...e)=>d.archiveCard&&d.archiveCard(...e))}," Archive Card ")):(0,l.kq)("v-if",!0),"Closed"!==e.kanbanStatus?((0,l.wg)(),(0,l.iD)("button",{key:1,class:"btn btn-primary save-changes",onClick:a[6]||(a[6]=e=>d.updateCard(!0))}," Save & Close ")):(0,l.kq)("v-if",!0),"Closed"!==e.kanbanStatus?((0,l.wg)(),(0,l.iD)("button",{key:2,class:"btn btn-success save-changes",onClick:a[7]||(a[7]=e=>d.updateCard(!1))}," Save & Continue ")):(0,l.kq)("v-if",!0)])])):(0,l.kq)("v-if",!0)])}]]),qa={key:0,class:"row"},ja=(0,l._)("div",{class:"col-md-4"},[(0,l._)("strong",null,"Notes"),(0,l._)("p",{class:"text-instructions"},' To add a note - type your note in the Note Box and hit the "Submit Note" button. ')],-1),Ba={class:"col-md-8"},Wa=(0,l._)("label",null,"Note Box",-1),Pa={key:1},Ka={key:2,class:"row"},Oa={class:"col-md-12"},Za=["disabled"],Fa={key:3};var Va=t(5007);const za={name:"CardNotes",components:{editor:le.Z,ListNotes:Va.Z},props:{},data:()=>({cardNoteModel:""}),computed:{...(0,N.Se)({cardNotes:"getCardNotes",contentCss:"getContentCss",kanbanStatus:"getKanbanStatus",rootUrl:"getRootUrl",skin:"getSkin",userLevel:"getUserLevel"})},methods:{addNote(){const e=new FormData;e.set("note",this.cardNoteModel),this.axios.post(`${this.rootUrl}object_data/kanban_card/${this.$store.state.card.cardId}/add_notes/`,e).then((e=>{this.$store.commit({type:"addNote",newNote:e.data[0]}),this.cardNoteModel=""})).catch((e=>{}))},closeModal(){document.getElementById("cardInformationModalCloseButton").click()}}},Ha=(0,E.Z)(za,[["render",function(e,a,t,s,o,n){const d=(0,l.up)("editor"),i=(0,l.up)("list-notes");return(0,l.wg)(),(0,l.iD)("div",null,[e.userLevel>1?((0,l.wg)(),(0,l.iD)("div",qa,[ja,(0,l._)("div",Ba,[Wa,(0,l.Wm)(d,{init:{height:250,menubar:!1,plugins:["lists","codesample","table"],toolbar:"undo redo | blocks | bold italic strikethrough underline backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | table image codesample",skin:`${this.skin}`,content_css:`${this.contentCss}`},modelValue:o.cardNoteModel,"onUpdate:modelValue":a[0]||(a[0]=e=>o.cardNoteModel=e),disabled:"Closed"===e.kanbanStatus},null,8,["init","modelValue","disabled"])])])):(0,l.kq)("v-if",!0),e.userLevel>1?((0,l.wg)(),(0,l.iD)("hr",Pa)):(0,l.kq)("v-if",!0),e.userLevel>1?((0,l.wg)(),(0,l.iD)("div",Ka,[(0,l._)("div",Oa,[(0,l._)("button",{class:"btn btn-secondary",onClick:a[1]||(a[1]=(...e)=>n.closeModal&&n.closeModal(...e))}," Close "),(0,l._)("button",{class:"btn btn-primary save-changes",onClick:a[2]||(a[2]=(...e)=>n.addNote&&n.addNote(...e)),disabled:""===o.cardNoteModel}," Add Note ",8,Za)])])):(0,l.kq)("v-if",!0),e.userLevel>1?((0,l.wg)(),(0,l.iD)("hr",Fa)):(0,l.kq)("v-if",!0),(0,l.kq)(" NOTE HISTORY "),(0,l.Wm)(i,{"note-history-results":e.cardNotes,destination:"card"},null,8,["note-history-results"])])}]]),Ya={class:"row"},Ga=(0,l._)("div",{class:"col-md-4"},[(0,l._)("strong",null,"Card Description"),(0,l._)("p",{class:"text-instructions"},' Fill out a detailed description for the card, then click on the "Update Card" button to update the card. ')],-1),Ja={class:"col-md-8"},Qa=(0,l._)("hr",null,null,-1),Xa={key:0,class:"row"},et={class:"col-md-12"},at={name:"CardDescription",components:{editor:le.Z},props:{},data:()=>({editorIsDisabled:!0}),computed:{...(0,N.Se)({contentCss:"getContentCss",kanbanStatus:"getKanbanStatus",skin:"getSkin",userLevel:"getUserLevel"}),cardDescription:{get(){return this.$store.state.card.cardDescription},set(e){this.$store.commit("updateValue",{field:"cardDescription",value:e})}}},mixins:[Ze.Z],methods:{closeModal(){document.getElementById("cardInformationModalCloseButton").click()},updateCard(e){this.$emit("update_card",{close_modal:e})}},mounted(){setInterval((()=>{this.editorIsDisabled="Closed"===this.kanbanStatus||this.userLevel<=1}),500)}},tt=(0,E.Z)(at,[["render",function(e,a,t,s,o,n){const d=(0,l.up)("editor");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l._)("div",Ya,[Ga,(0,l._)("div",Ja,[(0,l.Wm)(d,{init:{file_picker_types:"image",height:300,images_upload_handler:e.uploadImage,menubar:!1,paste_data_images:!0,plugins:["lists","image","codesample","table"],toolbar:"undo redo | blocks | bold italic strikethrough underline backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | table image codesample",skin:`${this.skin}`,content_css:`${this.contentCss}`},modelValue:n.cardDescription,"onUpdate:modelValue":a[0]||(a[0]=e=>n.cardDescription=e),disabled:o.editorIsDisabled},null,8,["init","modelValue","disabled"])])]),Qa,e.userLevel>1?((0,l.wg)(),(0,l.iD)("div",Xa,[(0,l._)("div",et,[(0,l._)("button",{class:"btn btn-warning",onClick:a[1]||(a[1]=(...e)=>n.closeModal&&n.closeModal(...e))}," Close & Discard Changes "),"Closed"!==e.kanbanStatus?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"btn btn-primary save-changes",onClick:a[2]||(a[2]=e=>n.updateCard(!0))}," Save & Close ")):(0,l.kq)("v-if",!0),"Closed"!==e.kanbanStatus?((0,l.wg)(),(0,l.iD)("button",{key:1,class:"btn btn-success save-changes",onClick:a[3]||(a[3]=e=>n.updateCard(!1))}," Save & Continue ")):(0,l.kq)("v-if",!0)])])):(0,l.kq)("v-if",!0)])}]]),lt={key:0,class:"alert alert-secondary"},st={key:1},ot={class:"table"},nt=(0,l._)("td",{scope:"col"},"Username",-1),dt=(0,l._)("td",{scope:"col"},"Name",-1),it={key:0,scope:"col"},rt={key:0},ct={key:2,class:"row"},ut={class:"col-md-12"},mt={name:"CardUsers",components:{Icon:R.JO},computed:{...(0,N.Se)({cardId:"getCardId",kanbanBoardStatus:"getKanbanStatus",locationId:"getLocationId",rootUrl:"getRootUrl",userLevel:"getUserLevel",objectUserList:"getObjectUserList"})},mixins:[T.Z],methods:{addUser(){document.getElementById("cardInformationModalCloseButton").click(),new x.u_("#addUserModal").show()},removeUser(e){const a=new FormData;a.set("username",e),this.axios.post(`${this.rootUrl}object_data/kanban_card/${this.locationId}/remove_user/`,a).then((e=>{this.$store.commit("updateGroupsAndUsers",{objectGroupList:e.data.object_group_list,objectUserList:e.data.object_user_list,potentialGroupList:e.data.potential_group_list,potentialUserList:e.data.potential_user_list})}))}}},bt=(0,E.Z)(mt,[["render",function(e,a,t,o,n,d){const i=(0,l.up)("Icon");return(0,l.wg)(),(0,l.iD)(l.HY,null,[0===e.objectUserList.length?((0,l.wg)(),(0,l.iD)("div",lt," Sorry, there are no users currently assigned to this card. ")):((0,l.wg)(),(0,l.iD)("div",st,[(0,l._)("table",ot,[(0,l._)("thead",null,[(0,l._)("tr",null,[nt,dt,4===e.userLevel?((0,l.wg)(),(0,l.iD)("td",it," Delete ")):(0,l.kq)("v-if",!0)])]),(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.objectUserList,(a=>((0,l.wg)(),(0,l.iD)("tr",{key:a.id},[(0,l._)("td",null,(0,s.toDisplayString)(a.id)+" - "+(0,s.toDisplayString)(a.username),1),(0,l._)("td",null,(0,s.toDisplayString)(a.first_name)+" "+(0,s.toDisplayString)(a.last_name),1),e.userLevel>=2?((0,l.wg)(),(0,l.iD)("td",rt,[(0,l.Wm)(i,{icon:e.icons.trashCan,onClick:e=>d.removeUser(a.username)},null,8,["icon","onClick"])])):(0,l.kq)("v-if",!0)])))),128))])])])),e.userLevel>1&&"Closed"!==e.kanbanBoardStatus?((0,l.wg)(),(0,l.iD)("div",ct,[(0,l._)("div",ut,[(0,l._)("button",{class:"btn btn-primary",onClick:a[0]||(a[0]=(...e)=>d.addUser&&d.addUser(...e))}," Add User ")])])):(0,l.kq)("v-if",!0)],64)}]]);var pt=t(8737),ht=t(7740),_t=t(4657);const vt={name:"CardInformation",components:{CardDescription:tt,CardDetails:Ea,CardNotes:Ha,CardUsers:bt,DocumentsModule:pt.Z,Icon:R.JO,ListPublicLinks:ht.Z,UploadDocumentWizard:_t.Z},mixins:[T.Z],data:()=>({cardDescriptionModel:"",cardNoteModel:"",cardTitleModel:"",noteHistoryResults:[]}),computed:{...(0,N.Se)({cardId:"getCardId",kanbanStatus:"getKanbanStatus",rootUrl:"getRootUrl"})},methods:{updateCard(e){this.$store.dispatch("newToast",{header:"Updating Current Card",message:"Please wait - we are updating the card's information",extra_classes:"bg-warning text-dark",unique_type:"update-card",delay:0});const a=this.$store.getters.getAllCardData,t=new FormData;t.set("kanban_card_text",a.cardTitle),t.set("kanban_card_description",a.cardDescription),t.set("kanban_level",a.cardLevel),t.set("kanban_column",a.cardColumn),t.set("kanban_card_id",a.cardId),t.set("kanban_card_priority",a.cardPriority),void 0!==e.new_destination&&e.new_destination.forEach((e=>{t.append("new_destination",e.pk)})),void 0!==e.old_destination&&e.old_destination.forEach((e=>{t.append("old_destination",e.pk)})),this.axios.post(`${this.rootUrl}kanban_information/update_card/`,t).then((()=>{this.$emit("update_card",{kanban_card_id:a.cardId,kanban_card_text:a.cardTitle,kanban_card_description:a.cardDescriptionModel}),this.$store.dispatch("newToast",{header:"Card successfully updated",message:"Your card has successfully update",extra_classes:"bg-success",unique_type:"update-card"}),e.close_modal&&document.getElementById("cardInformationModalCloseButton").click()})).catch((e=>{this.$store.dispatch("newToast",{header:"Card failed to updated",message:`Sorry your card failed to update - error -> ${e}`,extra_classes:"bg-danger",delay:0,unique_type:"update-card"})}))}}},kt=(0,E.Z)(vt,[["render",function(e,a,t,o,n,d){const i=(0,l.up)("Icon"),r=(0,l.up)("card-details"),c=(0,l.up)("card-description"),u=(0,l.up)("card-notes"),m=(0,l.up)("card-users"),b=(0,l.up)("documents-module"),p=(0,l.up)("list-public-links");return(0,l.wg)(),(0,l.iD)("div",ze,[(0,l._)("div",He,[(0,l._)("div",Ye,[(0,l._)("div",Ge,[(0,l._)("h2",null,[(0,l.Wm)(i,{icon:e.icons.usersIcon},null,8,["icon"]),(0,l.Uk)(" Card Information - "+(0,s.toDisplayString)(e.cardId),1)]),Je,Qe]),(0,l._)("div",Xe,[(0,l.kq)(" TAB MENU "),ea,aa,(0,l.kq)(" CONTENT OF TABS "),(0,l._)("div",ta,[(0,l._)("div",la,[(0,l.Wm)(r,{onUpdate_card:a[0]||(a[0]=e=>d.updateCard(e))})]),(0,l._)("div",sa,[(0,l.Wm)(c,{onUpdate_card:a[1]||(a[1]=e=>d.updateCard(e))})]),(0,l._)("div",oa,[(0,l.Wm)(u)]),(0,l._)("div",na,[(0,l.Wm)(m)]),(0,l._)("div",da,[(0,l.Wm)(b,{"override-destination":"kanban_card","override-location-id":e.cardId,"read-only":"Closed"===e.kanbanStatus},null,8,["override-location-id","read-only"])]),(0,l._)("div",ia,[(0,l.Wm)(p,{"override-destination":"kanban_card","override-location-id":e.cardId,"is-read-only":"Closed"===e.kanbanStatus},null,8,["override-location-id","is-read-only"])])])])])])])}]]),gt={class:"modal fade",id:"newLinkModal",tabindex:"-1","aria-labelledby":"kanbanLinkModal","aria-hidden":"true"},Ct={class:"modal-dialog modal-lg modal-fullscreen-lg-down"},yt={class:"modal-content"},ft={class:"modal-header"},wt=(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"requirementLinkCloseButton"},[(0,l._)("span",{"aria-hidden":"true"})],-1),Lt={class:"modal-body"},Dt={class:"row"},It=(0,l._)("div",{class:"col-md-4"},[(0,l._)("strong",null,"Object Selector"),(0,l._)("p",{class:"text-instructions"}," Please select which object you would like to link to this requirement. ")],-1),Mt={class:"col-md-8"},St={key:1,class:"alert alert-success"},Ut={key:0},Rt={key:1,class:"row"},$t=(0,l._)("div",{class:"col-md-4"},[(0,l._)("strong",null,"Card Location"),(0,l._)("p",{class:"text-instructions"}," Select the appropriate location for this card. ")],-1),xt={class:"col-md-8"},Nt={class:"row"},Tt={class:"col-md-6 mt-4"},At=(0,l._)("label",null,"Card Column",-1),Et={class:"col-md-6 mt-4"},qt=(0,l._)("label",null,"Card Level",-1),jt=(0,l._)("hr",null,null,-1),Bt={class:"row"},Wt=(0,l._)("div",{class:"col-md-4"},[(0,l._)("strong",null,"Select Links"),(0,l._)("p",{class:"text-instructions"}," Please select which of the objects you want to connect to this requirement. ")],-1),Pt={class:"col-md-8"},Kt={key:0,id:"link_wizard_results"},Ot=["src"],Zt={key:1,class:"alert alert-warning"},Ft={key:2,class:"form-group"},Vt=(0,l._)("label",null,"Search Terms",-1),zt=(0,l._)("br",null,null,-1),Ht={key:3,class:"table"},Yt=(0,l._)("td",null,"Status",-1),Gt={key:0},Jt={class:"form-check"},Qt=["value","id"],Xt=["for"],el=(0,l._)("div",{class:"spacer"},null,-1),al={class:"small-text"},tl={key:1},ll={class:"form-check"},sl=["value","id"],ol=["for"],nl=(0,l._)("div",{class:"spacer"},null,-1),dl={class:"small-text"},il={key:2},rl={class:"form-check"},cl=["value","id"],ul=["for"],ml=(0,l._)("div",{class:"spacer"},null,-1),bl={class:"small-text"},pl={class:"modal-footer"},hl=(0,l._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),_l=["disabled"],vl={name:"NewKanbanLinkWizard",components:{Icon:R.JO,NSelect:$.Z},props:{columnResults:{type:Array,default:()=>[]},levelResults:{type:Array,default:()=>[]},locationId:{type:Number,default:0}},computed:{...(0,N.Se)({listColumns:"getListColumns",listLevels:"getListLevels",newCardLocation:"getNewCardLocation",rootUrl:"getRootUrl",staticUrl:"getStaticUrl"})},mixins:[T.Z],data:()=>({isSearching:!1,linkModel:[],localColumnId:0,localLevelId:0,objectModel:null,objectFilteredResults:[],objectResults:[],objectSelection:[{value:"Project",label:"Project"},{value:"Requirement",label:"Requirement"},{value:"Task",label:"Task"}],searchTermModel:""}),methods:{saveLinks(){const e=new FormData;e.set(`${this.objectModel.toLowerCase()}`,this.linkModel),e.set("kanban_level",this.localLevelId),e.set("kanban_column",this.localColumnId),this.axios.post(`${this.rootUrl}kanban_information/${this.locationId}/${this.objectModel.toLowerCase()}/add_link/`,e).then((e=>{this.$emit("new_card",e.data),this.objectModel=null,document.getElementById("requirementLinkCloseButton").click()}))}},watch:{newCardLocation:{handler(e){this.localColumnId=e.columnId,this.localLevelId=e.levelId},deep:!0,immediate:!0},objectModel(){this.linkModel=[],null!==this.objectModel?(this.isSearching=!0,this.axios.post(`${this.rootUrl}kanban_information/${this.locationId}/${this.objectModel}/link_list/`).then((e=>{this.objectResults=e.data,this.objectFilteredResults=e.data,this.isSearching=!1,this.searchTermModel=""})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Getting Link List",message:`We had an issue getting Link List. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))):this.isSearching=!1},searchTermModel(){""!==this.searchTermModel&&null!==this.searchTermModel?this.objectFilteredResults=this.objectResults.filter((e=>{let a="";return a=void 0!==e.fields.project_description?e.fields.project_description.toLowerCase():e.fields.task_short_description.toLowerCase(),a.includes(this.searchTermModel.toLowerCase())})):this.objectFilteredResults=this.objectResults}}},kl=(0,E.Z)(vl,[["render",function(e,a,t,o,n,d){const i=(0,l.up)("Icon"),r=(0,l.up)("n-select");return(0,l.wg)(),(0,l.iD)("div",gt,[(0,l._)("div",Ct,[(0,l._)("div",yt,[(0,l._)("div",ft,[(0,l._)("h2",null,[(0,l.Wm)(i,{icon:e.icons.linkOut},null,8,["icon"]),(0,l.Uk)(" New Kanban Link Wizard ")]),wt]),(0,l._)("div",Lt,[(0,l.kq)(" CHOOSING A OBJECT TYPE "),(0,l._)("div",Dt,[It,(0,l._)("div",Mt,[n.isSearching?((0,l.wg)(),(0,l.iD)("div",St," Searching for "+(0,s.toDisplayString)(n.objectModel)+"s ",1)):((0,l.wg)(),(0,l.j4)(r,{key:0,options:n.objectSelection,value:n.objectModel,"onUpdate:value":a[0]||(a[0]=e=>n.objectModel=e),class:"object-selection"},null,8,["options","value"]))])]),(0,l.kq)(" CARD LOCATION "),e.newCardLocation.userCanSelectLocation?((0,l.wg)(),(0,l.iD)("hr",Ut)):(0,l.kq)("v-if",!0),e.newCardLocation.userCanSelectLocation?((0,l.wg)(),(0,l.iD)("div",Rt,[$t,(0,l._)("div",xt,[(0,l._)("div",Nt,[(0,l._)("div",Tt,[At,(0,l.Wm)(r,{options:e.listColumns,label:"column",value:n.localColumnId,"onUpdate:value":a[1]||(a[1]=e=>n.localColumnId=e)},null,8,["options","value"])]),(0,l._)("div",Et,[qt,(0,l.Wm)(r,{options:e.listLevels,label:"level",value:n.localLevelId,"onUpdate:value":a[2]||(a[2]=e=>n.localLevelId=e)},null,8,["options","value"])])])])])):(0,l.kq)("v-if",!0),(0,l.kq)(" SELECTING WHICH OBJECTS TO LINK TO "),jt,(0,l._)("div",Bt,[Wt,(0,l._)("div",Pt,[(0,l.kq)(" LOADING PLACEHOLDER "),n.isSearching||null==n.objectModel?((0,l.wg)(),(0,l.iD)("div",Kt,[(0,l._)("img",{src:`${e.staticUrl}/NearBeach/images/placeholder/search.svg`,alt:"Searching..."},null,8,Ot)])):(0,l.kq)("v-if",!0),0===n.objectResults.length&&null!=n.objectModel?((0,l.wg)(),(0,l.iD)("div",Zt," Sorry - there are no results. ")):(0,l.kq)("v-if",!0),(0,l.kq)(" SEARCH RESULTS "),!n.isSearching&&n.objectResults.length>0&&null!=n.objectModel?((0,l.wg)(),(0,l.iD)("div",Ft,[Vt,(0,l.wy)((0,l._)("input",{id:"search_terms",class:"form-control","onUpdate:modelValue":a[3]||(a[3]=e=>n.searchTermModel=e),type:"text"},null,512),[[me.vModelText,n.searchTermModel]])])):(0,l.kq)("v-if",!0),zt,(0,l.kq)(" TABLE CONTAINING RESULTS "),!n.isSearching&&n.objectFilteredResults.length>0&&null!=n.objectModel?((0,l.wg)(),(0,l.iD)("table",Ht,[(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("td",null,(0,s.toDisplayString)(n.objectModel)+" Description",1),Yt])]),(0,l.kq)(" PROJECTS "),"Project"==n.objectModel?((0,l.wg)(),(0,l.iD)("tbody",Gt,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.objectFilteredResults,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.pk},[(0,l._)("td",null,[(0,l._)("div",Jt,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"radio",name:"link-option",value:e.pk,id:`radio_project_${e.pk}`,"onUpdate:modelValue":a[4]||(a[4]=e=>n.linkModel=e)},null,8,Qt),[[me.vModelRadio,n.linkModel]]),(0,l._)("label",{class:"form-check-label",for:`radio_project_${e.pk}`},(0,s.toDisplayString)(e.fields.project_name),9,Xt)]),el,(0,l._)("p",al," Project "+(0,s.toDisplayString)(e.pk),1)]),(0,l._)("td",null,(0,s.toDisplayString)(e.fields.project_status),1)])))),128))])):(0,l.kq)("v-if",!0),(0,l.kq)(" REQUIREMENTS "),"Requirement"==n.objectModel?((0,l.wg)(),(0,l.iD)("tbody",tl,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.objectFilteredResults,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.pk},[(0,l._)("td",null,[(0,l._)("div",ll,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"radio",name:"link-option",value:e.pk,id:`radio_requirement_${e.pk}`,"onUpdate:modelValue":a[5]||(a[5]=e=>n.linkModel=e)},null,8,sl),[[me.vModelRadio,n.linkModel]]),(0,l._)("label",{class:"form-check-label",for:`radio_task_${e.pk}`},(0,s.toDisplayString)(e.fields.requirement_title),9,ol)]),nl,(0,l._)("p",dl," Requirement "+(0,s.toDisplayString)(e.pk),1)]),(0,l._)("td",null,(0,s.toDisplayString)(e.fields.requirement_status),1)])))),128))])):(0,l.kq)("v-if",!0),(0,l.kq)(" TASKS "),"Task"===n.objectModel?((0,l.wg)(),(0,l.iD)("tbody",il,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.objectFilteredResults,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.pk},[(0,l._)("td",null,[(0,l._)("div",rl,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"radio",value:e.pk,id:`radio_task_${e.pk}`,"onUpdate:modelValue":a[6]||(a[6]=e=>n.linkModel=e)},null,8,cl),[[me.vModelRadio,n.linkModel]]),(0,l._)("label",{class:"form-check-label",for:`radio_task_${e.pk}`},(0,s.toDisplayString)(e.fields.task_short_description),9,ul)]),ml,(0,l._)("p",bl," Task "+(0,s.toDisplayString)(e.pk),1)]),(0,l._)("td",null,(0,s.toDisplayString)(e.fields.task_status),1)])))),128))])):(0,l.kq)("v-if",!0)])):(0,l.kq)("v-if",!0)])])]),(0,l._)("div",pl,[hl,(0,l._)("button",{type:"button",class:"btn btn-primary",disabled:0===n.linkModel.length,onClick:a[7]||(a[7]=(...e)=>d.saveLinks&&d.saveLinks(...e))}," Save changes ",8,_l)])])])])}]]),gl={class:"modal fade",id:"confirmCardArchiveModal",tabindex:"-1","aria-labelledby":"confirmCardArchiveModalLabel","aria-hidden":"true"},Cl={class:"modal-dialog modal-lg"},yl={class:"modal-content"},fl=(0,l._)("div",{class:"modal-header"},[(0,l._)("h2",null,"Card Information"),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmCardArchiveModalCloseButton"},[(0,l._)("span",{"aria-hidden":"true"})])],-1),wl={class:"modal-body"},Ll=(0,l._)("div",{class:"alert alert-danger"}," Please note - archiving the card can not be undone. ",-1),Dl=(0,l._)("h3",null," Are you sure you want to archive the following card? ",-1),Il={class:"row"},Ml={class:"col"},Sl=(0,l._)("br",null,null,-1),Ul={class:"row"},Rl={class:"col"},$l={class:"modal-footer"},xl={name:"ConfirmCardArchive",computed:{...(0,N.Se)({cardId:"getCardId",cardTitle:"getCardTitle",rootUrl:"getRootUrl"})},methods:{archiveCard(){const e=new FormData;e.append("kanban_card_id",this.cardId),this.$store.commit({type:"archiveCard",cardId:this.cardId}),document.getElementById("confirmCardArchiveModalCloseButton").click(),this.axios.post(`${this.rootUrl}kanban_information/archive_kanban_cards/`,e).catch((e=>{}))},goBack(){document.getElementById("confirmCardArchiveModalCloseButton").click(),new x.u_("#cardInformationModal").show()}}},Nl=(0,E.Z)(xl,[["render",function(e,a,t,o,n,d){return(0,l.wg)(),(0,l.iD)("div",gl,[(0,l._)("div",Cl,[(0,l._)("div",yl,[fl,(0,l._)("div",wl,[Ll,Dl,(0,l._)("div",Il,[(0,l._)("div",Ml,"Card No. - "+(0,s.toDisplayString)(e.cardId),1)]),Sl,(0,l._)("div",Ul,[(0,l._)("div",Rl,"Card Title - "+(0,s.toDisplayString)(e.cardTitle),1)])]),(0,l._)("div",$l,[(0,l._)("button",{type:"button",class:"btn btn-danger",onClick:a[0]||(a[0]=(...e)=>d.archiveCard&&d.archiveCard(...e))}," Yes Archive Card "),(0,l._)("button",{type:"button",class:"btn btn-secondary",onClick:a[1]||(a[1]=(...e)=>d.goBack&&d.goBack(...e))}," No go back ")])])])])}]]);var Tl=t(6916),Al=t(624),El=t(9401),ql=t(5050),jl=t(5014),Bl=t(6505),Wl=t(8576),Pl=t(3027);const Kl={name:"KanbanInformation",components:{ConfirmNoteDelete:t(9159).Z,NewHistoryNoteWizard:Pl.Z,EditHistoryNoteWizard:Wl.Z,ConfirmFolderDelete:Bl.Z,ConfirmFileDeleteVue:jl.Z,AddLinkWizard:ql.Z,AddFolderWizard:El.Z,UploadDocumentWizard:_t.Z,AddUserToCard:q,ArchiveCards:V,BlockedNotesModal:oe,CardInformation:kt,ConfirmCardArchive:Nl,KanbanBoard:ue,NewKanbanCard:Ve,NewKanbanLinkWizard:kl,NSwitch:Tl.Z},props:{columnResults:{type:Array,default:()=>[]},kanbanBoardResults:{type:Array,default:()=>[]},kanbanCardResults:{type:Array,default:()=>[]},kanbanSettings:{type:Object,default:()=>({setting_data:{canDragCards:!0,levels:[]}})},levelResults:{type:Array,default:()=>[]},locationId:{type:Number,default:0},openCardOnLoad:{type:Number,default:0},potentialUserList:{type:Array,default:()=>[]},rootUrl:{type:String,default:"/"},staticUrl:{type:String,default:"/"},theme:{type:String,default:""},userLevel:{type:Number,default:0}},computed:{...(0,N.Se)({cardId:"getCardId"})},watch:{cardId(){this.refreshUserList=!0}},mixins:[Al.Z],data(){return{canDragCards:!0,cardInformation:{},localKanbanCardResults:this.kanbanCardResults,refreshUserList:!1,newCardInfo:[]}},methods:{addNewKanbanCard(){this.$store.commit({type:"updateNewCardLocation",columnId:this.columnResults[0].pk,levelId:this.levelResults[0].pk,userCanSelectLocation:!0}),new x.u_(document.getElementById("addKanbanCardModal")).show()},addNewLink(){this.$store.commit({type:"updateNewCardLocation",columnId:this.columnResults[0].pk,levelId:this.levelResults[0].pk,userCanSelectLocation:!0}),new x.u_(document.getElementById("newLinkModal")).show()},doubleClickedCard(e){this.cardInformation=e},newCard(e){this.$store.commit({type:"addCard",newCard:e})},resetRefreshUserList(){this.refreshUserList=!1},updateCanDragCards(e){this.$store.dispatch({type:"updateCanDragCards",canDragCards:e})},updateCard(e){this.localKanbanCardResults.forEach(((a,t)=>{a.pk===e.kanban_card_id&&(this.localKanbanCardResults[t].fields.kanban_card_text=e.kanban_card_text,this.localKanbanCardResults[t].fields.kanban_card_description=e.kanban_card_description)}))},updateKanbanSettings(){if(void 0===this.kanbanSettings.setting_data)return void this.$store.commit({type:"initKanbanSettings",canDragCards:!0,levels:this.levelResults.map((e=>({level_id:e.pk,is_collapsed:!1})))});let e=this.kanbanSettings.setting_data.canDragCards;void 0===e&&(e=!0),this.canDragCards=e;let a=this.kanbanSettings.setting_data.levels;void 0===a&&(a=[]);const t=a.map((e=>e.level_id));this.levelResults.filter((e=>-1===t.indexOf(e.pk))).forEach((e=>{a.push({level_id:e.pk,is_collapsed:!1})}));const l=this.levelResults.map((e=>e.pk));a=a.filter((e=>l.indexOf(e.level_id)>=0)),this.$store.commit({type:"initKanbanSettings",canDragCards:e,levels:a})}},async beforeMount(){await this.$store.dispatch("processThemeUpdate",{theme:this.theme})},mounted(){this.updateKanbanSettings(),this.$store.commit({type:"initPayload",kanbanCardResults:this.kanbanCardResults,levelResults:this.levelResults,columnResults:this.columnResults,openCardOnLoad:this.openCardOnLoad}),this.$store.commit({type:"updateUrl",rootUrl:this.rootUrl,staticUrl:this.staticUrl}),this.$store.commit({type:"updateDestination",destination:"kanban_board",locationId:this.locationId}),this.$store.commit({type:"updateLists",columnResults:this.columnResults,levelResults:this.levelResults}),this.$store.commit({type:"updateUserLevel",userLevel:this.userLevel}),this.$store.commit({type:"updateGroupsAndUsers",potentialUserList:this.potentialUserList})}},Ol=(0,E.Z)(Kl,[["render",function(e,a,t,p,h,_){const v=(0,l.up)("n-switch"),k=(0,l.up)("kanban-board"),g=(0,l.up)("add-user-to-card"),C=(0,l.up)("archive-cards"),y=(0,l.up)("blocked-notes-modal"),f=(0,l.up)("confirm-card-archive"),w=(0,l.up)("new-kanban-card"),L=(0,l.up)("card-information"),D=(0,l.up)("upload-document-wizard"),I=(0,l.up)("edit-history-note-wizard"),M=(0,l.up)("new-history-note-wizard"),S=(0,l.up)("confirm-note-delete"),U=(0,l.up)("add-folder-wizard"),R=(0,l.up)("add-link-wizard"),$=(0,l.up)("confirm-file-delete-vue"),x=(0,l.up)("confirm-folder-delete"),N=(0,l.up)("new-kanban-link-wizard"),T=(0,l.up)("n-config-provider");return(0,l.wg)(),(0,l.j4)(T,{theme:e.getTheme(t.theme)},{default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l._)("h1",o,(0,s.toDisplayString)(t.kanbanBoardResults[0].fields.kanban_board_name),1),t.userLevel>=2?((0,l.wg)(),(0,l.iD)("div",n,[d,(0,l._)("ul",i,[(0,l._)("li",null,[(0,l._)("a",r,["Closed"!==t.kanbanBoardResults[0].fields.kanban_board_status&&t.userLevel>=2?((0,l.wg)(),(0,l.j4)(v,{key:0,value:h.canDragCards,"onUpdate:value":[a[0]||(a[0]=e=>h.canDragCards=e),_.updateCanDragCards]},{checked:(0,l.w5)((()=>[(0,l.Uk)(" Can Drag Cards ")])),unchecked:(0,l.w5)((()=>[(0,l.Uk)(" Card Position Locked ")])),_:1},8,["value","onUpdate:value"])):(0,l.kq)("v-if",!0)])]),(0,l._)("li",null,[t.userLevel>=3?((0,l.wg)(),(0,l.iD)("hr",c)):(0,l.kq)("v-if",!0)]),(0,l._)("li",null,[(0,l._)("a",{class:"dropdown-item",href:"#",onClick:a[1]||(a[1]=e=>_.addNewKanbanCard())}," Add New Card ")]),(0,l._)("li",null,[(0,l._)("a",{class:"dropdown-item",href:"#",onClick:a[2]||(a[2]=e=>_.addNewLink())}," Add New Link to Object ")]),(0,l._)("li",null,[t.userLevel>=3?((0,l.wg)(),(0,l.iD)("hr",u)):(0,l.kq)("v-if",!0)]),(0,l._)("li",null,[t.userLevel>=3?((0,l.wg)(),(0,l.iD)("a",{key:0,class:"dropdown-item",href:`${t.rootUrl}kanban_information/${t.kanbanBoardResults[0].pk}/edit_board/`}," Edit Kanban ",8,m)):(0,l.kq)("v-if",!0)])])])):(0,l.kq)("v-if",!0),t.userLevel<=1?((0,l.wg)(),(0,l.iD)("div",b)):(0,l.kq)("v-if",!0),(0,l.kq)(" Rendering the Kanban Container "),(0,l.Wm)(k,{"kanban-board-results":t.kanbanBoardResults,"new-card-info":h.newCardInfo,onDouble_clicked_card:a[3]||(a[3]=e=>_.doubleClickedCard(e))},null,8,["kanban-board-results","new-card-info"]),(0,l.kq)(" MODALS "),(0,l.Wm)(g,{destination:"kanban_card","location-id":e.cardId,"refresh-user-list":h.refreshUserList,onReset_refresh_user_list:_.resetRefreshUserList},null,8,["location-id","refresh-user-list","onReset_refresh_user_list"]),(0,l.Wm)(C),(0,l.Wm)(y),(0,l.Wm)(f,{"card-information":h.cardInformation},null,8,["card-information"]),(0,l.Wm)(w,{"kanban-card-results":t.kanbanCardResults,"column-results":t.columnResults,"level-results":t.levelResults,"kanban-board-results":t.kanbanBoardResults,onNew_card:a[4]||(a[4]=e=>_.newCard(e))},null,8,["kanban-card-results","column-results","level-results","kanban-board-results"]),(0,l.Wm)(L,{"card-information":h.cardInformation,onUpdate_card:a[5]||(a[5]=e=>_.updateCard(e))},null,8,["card-information"]),(0,l.Wm)(D,{"override-destination":"kanban_card","override-location-id":e.cardId},null,8,["override-location-id"]),(0,l.Wm)(I),(0,l.Wm)(M,{"location-id":e.cardId,destination:"kanban_card"},null,8,["location-id"]),(0,l.Wm)(S),(0,l.Wm)(U,{destination:"kanban_card","location-id":t.locationId},null,8,["location-id"]),(0,l.Wm)(R,{destination:"kanban_card","location-id":t.locationId},null,8,["location-id"]),(0,l.kq)(" CONFIRM DOCUMENT DELETE "),(0,l.Wm)($),(0,l.Wm)(x),(0,l.Wm)(N,{"location-id":t.locationId,"column-results":t.columnResults,"level-results":t.levelResults,onNew_card:a[6]||(a[6]=e=>_.newCard(e))},null,8,["location-id","column-results","level-results"])])])),_:1},8,["theme"])}]])},2299:(e,a,t)=>{t.d(a,{Z:()=>o});var l=t(9669),s=t.n(l);const o={computed:{...(0,t(989).Se)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl"})},methods:{uploadImage(e,a){const t=new FormData;t.set("document",e.blob(),e.filename()),t.set("document_description",e.filename());const l={onUploadProgress:e=>{parseFloat(e.loaded),parseFloat(e.total)}};return this.axios.post(`${this.rootUrl}documentation/${this.destination}/${this.locationId}/upload/`,t,l).then((e=>`/private/${e.data[0].document_key_id}`)).catch((e=>{this.$store.dispatch("newToast",{header:"Failed to upload image",message:`Sorry, could not upload image. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},newObjectUploadImage(e,a){const t=new FormData;t.set("document",e.blob(),e.filename()),t.set("document_description",e.filename()),t.set("uuid",this.uuid);const l={onUploadProgress:e=>{parseFloat(e.loaded),parseFloat(e.total)}};return s().post(`${this.rootUrl}documentation/new_object_upload/`,t,l).then((e=>`/private/${e.data[0].document_key_id}`)).catch((e=>{this.$store.dispatch("newToast",{header:"Failed to upload image",message:`Sorry, could not upload image. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))}}}}}]);