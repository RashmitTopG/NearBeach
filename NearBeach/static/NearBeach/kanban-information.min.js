"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[1616],{6916:(e,a,t)=>{t.d(a,{Z:()=>I});var n=t(6252),l=t(2262),o=t(834),s=t(9960),d=t(5103),i=t(6135),r=t(9699),c=t(2366),u=t(3079),b=t(945),m=t(1263),h=t(2326),p=t(6810),k=t(5944),_=t(3910);const v={name:"Switch",common:t(8373).Z,self:e=>{const{primaryColor:a,opacityDisabled:t,borderRadius:n,textColor3:l}=e;return Object.assign(Object.assign({},_.Z),{iconColor:l,textColor:"white",loadingColor:a,opacityDisabled:t,railColor:"rgba(0, 0, 0, .14)",railColorActive:a,buttonBoxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.3), inset 0 0 1px 0 rgba(0, 0, 0, 0.05)",buttonColor:"#FFF",railBorderRadiusSmall:n,railBorderRadiusMedium:n,railBorderRadiusLarge:n,buttonBorderRadiusSmall:n,buttonBorderRadiusMedium:n,buttonBorderRadiusLarge:n,boxShadowFocus:`0 0 0 2px ${(0,k.zX)(a,{alpha:.2})}`})}};var g=t(9197),f=t(9474);const C=(0,f.cB)("switch","\n height: var(--n-height);\n min-width: var(--n-width);\n vertical-align: middle;\n user-select: none;\n -webkit-user-select: none;\n display: inline-flex;\n outline: none;\n justify-content: center;\n align-items: center;\n",[(0,f.cE)("children-placeholder","\n height: var(--n-rail-height);\n display: flex;\n flex-direction: column;\n overflow: hidden;\n pointer-events: none;\n visibility: hidden;\n "),(0,f.cE)("rail-placeholder","\n display: flex;\n flex-wrap: none;\n "),(0,f.cE)("button-placeholder","\n width: calc(1.75 * var(--n-rail-height));\n height: var(--n-rail-height);\n "),(0,f.cB)("base-loading","\n position: absolute;\n top: 50%;\n left: 50%;\n transform: translateX(-50%) translateY(-50%);\n font-size: calc(var(--n-button-width) - 4px);\n color: var(--n-loading-color);\n transition: color .3s var(--n-bezier);\n ",[(0,g.c)({left:"50%",top:"50%",originalTransform:"translateX(-50%) translateY(-50%)"})]),(0,f.cE)("checked, unchecked","\n transition: color .3s var(--n-bezier);\n color: var(--n-text-color);\n box-sizing: border-box;\n position: absolute;\n white-space: nowrap;\n top: 0;\n bottom: 0;\n display: flex;\n align-items: center;\n line-height: 1;\n "),(0,f.cE)("checked","\n right: 0;\n padding-right: calc(1.25 * var(--n-rail-height) - var(--n-offset));\n "),(0,f.cE)("unchecked","\n left: 0;\n justify-content: flex-end;\n padding-left: calc(1.25 * var(--n-rail-height) - var(--n-offset));\n "),(0,f.c)("&:focus",[(0,f.cE)("rail","\n box-shadow: var(--n-box-shadow-focus);\n ")]),(0,f.cM)("round",[(0,f.cE)("rail","border-radius: calc(var(--n-rail-height) / 2);",[(0,f.cE)("button","border-radius: calc(var(--n-button-height) / 2);")])]),(0,f.u4)("disabled",[(0,f.u4)("icon",[(0,f.cM)("rubber-band",[(0,f.cM)("pressed",[(0,f.cE)("rail",[(0,f.cE)("button","max-width: var(--n-button-width-pressed);")])]),(0,f.cE)("rail",[(0,f.c)("&:active",[(0,f.cE)("button","max-width: var(--n-button-width-pressed);")])]),(0,f.cM)("active",[(0,f.cM)("pressed",[(0,f.cE)("rail",[(0,f.cE)("button","left: calc(100% - var(--n-offset) - var(--n-button-width-pressed));")])]),(0,f.cE)("rail",[(0,f.c)("&:active",[(0,f.cE)("button","left: calc(100% - var(--n-offset) - var(--n-button-width-pressed));")])])])])])]),(0,f.cM)("active",[(0,f.cE)("rail",[(0,f.cE)("button","left: calc(100% - var(--n-button-width) - var(--n-offset))")])]),(0,f.cE)("rail","\n overflow: hidden;\n height: var(--n-rail-height);\n min-width: var(--n-rail-width);\n border-radius: var(--n-rail-border-radius);\n cursor: pointer;\n position: relative;\n transition:\n opacity .3s var(--n-bezier),\n background .3s var(--n-bezier),\n box-shadow .3s var(--n-bezier);\n background-color: var(--n-rail-color);\n ",[(0,f.cE)("button-icon","\n color: var(--n-icon-color);\n transition: color .3s var(--n-bezier);\n font-size: calc(var(--n-button-height) - 4px);\n position: absolute;\n left: 0;\n right: 0;\n top: 0;\n bottom: 0;\n display: flex;\n justify-content: center;\n align-items: center;\n line-height: 1;\n ",[(0,g.c)()]),(0,f.cE)("button",'\n align-items: center; \n top: var(--n-offset);\n left: var(--n-offset);\n height: var(--n-button-height);\n width: var(--n-button-width-pressed);\n max-width: var(--n-button-width);\n border-radius: var(--n-button-border-radius);\n background-color: var(--n-button-color);\n box-shadow: var(--n-button-box-shadow);\n box-sizing: border-box;\n cursor: inherit;\n content: "";\n position: absolute;\n transition:\n background-color .3s var(--n-bezier),\n left .3s var(--n-bezier),\n opacity .3s var(--n-bezier),\n max-width .3s var(--n-bezier),\n box-shadow .3s var(--n-bezier);\n ')]),(0,f.cM)("active",[(0,f.cE)("rail","background-color: var(--n-rail-color-active);")]),(0,f.cM)("loading",[(0,f.cE)("rail","\n cursor: wait;\n ")]),(0,f.cM)("disabled",[(0,f.cE)("rail","\n cursor: not-allowed;\n opacity: .5;\n ")])]),y=Object.assign(Object.assign({},d.Z.props),{size:{type:String,default:"medium"},value:{type:[String,Number,Boolean],default:void 0},loading:Boolean,defaultValue:{type:[String,Number,Boolean],default:!1},disabled:{type:Boolean,default:void 0},round:{type:Boolean,default:!0},"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],checkedValue:{type:[String,Number,Boolean],default:!0},uncheckedValue:{type:[String,Number,Boolean],default:!1},railStyle:Function,rubberBand:{type:Boolean,default:!0},onChange:[Function,Array]});let w;const I=(0,n.aZ)({name:"Switch",props:y,setup(e){void 0===w&&(w="undefined"==typeof CSS||void 0!==CSS.supports&&CSS.supports("width","max(1px)"));const{mergedClsPrefixRef:a,inlineThemeDisabled:t}=(0,i.Z)(e),u=(0,d.Z)("Switch","-switch",C,v,e,a),b=(0,r.Z)(e),{mergedSizeRef:p,mergedDisabledRef:k}=b,_=(0,l.iH)(e.defaultValue),g=(0,l.Vh)(e,"value"),f=(0,s.Z)(g,_),y=(0,n.Fl)((()=>f.value===e.checkedValue)),I=(0,l.iH)(!1),D=(0,l.iH)(!1),L=(0,n.Fl)((()=>{const{railStyle:a}=e;if(a)return a({focused:D.value,checked:y.value})}));function M(a){const{"onUpdate:value":t,onChange:n,onUpdateValue:l}=e,{nTriggerFormInput:o,nTriggerFormChange:s}=b;t&&(0,m.R)(t,a),l&&(0,m.R)(l,a),n&&(0,m.R)(n,a),_.value=a,o(),s()}const S=(0,n.Fl)((()=>{const{value:e}=p,{self:{opacityDisabled:a,railColor:t,railColorActive:n,buttonBoxShadow:l,buttonColor:s,boxShadowFocus:d,loadingColor:i,textColor:r,iconColor:c,[(0,h.T)("buttonHeight",e)]:b,[(0,h.T)("buttonWidth",e)]:m,[(0,h.T)("buttonWidthPressed",e)]:k,[(0,h.T)("railHeight",e)]:_,[(0,h.T)("railWidth",e)]:v,[(0,h.T)("railBorderRadius",e)]:g,[(0,h.T)("buttonBorderRadius",e)]:f},common:{cubicBezierEaseInOut:C}}=u.value;let y,I,D;return w?(y=`calc((${_} - ${b}) / 2)`,I=`max(${_}, ${b})`,D=`max(${v}, calc(${v} + ${b} - ${_}))`):(y=(0,o.BL)(((0,o.fQ)(_)-(0,o.fQ)(b))/2),I=(0,o.BL)(Math.max((0,o.fQ)(_),(0,o.fQ)(b))),D=(0,o.fQ)(_)>(0,o.fQ)(b)?v:(0,o.BL)((0,o.fQ)(v)+(0,o.fQ)(b)-(0,o.fQ)(_))),{"--n-bezier":C,"--n-button-border-radius":f,"--n-button-box-shadow":l,"--n-button-color":s,"--n-button-width":m,"--n-button-width-pressed":k,"--n-button-height":b,"--n-height":I,"--n-offset":y,"--n-opacity-disabled":a,"--n-rail-border-radius":g,"--n-rail-color":t,"--n-rail-color-active":n,"--n-rail-height":_,"--n-rail-width":v,"--n-width":D,"--n-box-shadow-focus":d,"--n-loading-color":i,"--n-text-color":r,"--n-icon-color":c}})),x=t?(0,c.F)("switch",(0,n.Fl)((()=>p.value[0])),S,e):void 0;return{handleClick:function(){e.loading||k.value||(f.value!==e.checkedValue?M(e.checkedValue):M(e.uncheckedValue))},handleBlur:function(){D.value=!1,function(){const{nTriggerFormBlur:e}=b;e()}(),I.value=!1},handleFocus:function(){D.value=!0,function(){const{nTriggerFormFocus:e}=b;e()}()},handleKeyup:function(a){e.loading||k.value||" "===a.key&&(f.value!==e.checkedValue?M(e.checkedValue):M(e.uncheckedValue),I.value=!1)},handleKeydown:function(a){e.loading||k.value||" "===a.key&&(a.preventDefault(),I.value=!0)},mergedRailStyle:L,pressed:I,mergedClsPrefix:a,mergedValue:f,checked:y,mergedDisabled:k,cssVars:t?void 0:S,themeClass:null==x?void 0:x.themeClass,onRender:null==x?void 0:x.onRender}},render(){const{mergedClsPrefix:e,mergedDisabled:a,checked:t,mergedRailStyle:l,onRender:o,$slots:s}=this;null==o||o();const{checked:d,unchecked:i,icon:r,"checked-icon":c,"unchecked-icon":m}=s,h=!((0,p.aD)(r)&&(0,p.aD)(c)&&(0,p.aD)(m));return(0,n.h)("div",{role:"switch","aria-checked":t,class:[`${e}-switch`,this.themeClass,h&&`${e}-switch--icon`,t&&`${e}-switch--active`,a&&`${e}-switch--disabled`,this.round&&`${e}-switch--round`,this.loading&&`${e}-switch--loading`,this.pressed&&`${e}-switch--pressed`,this.rubberBand&&`${e}-switch--rubber-band`],tabindex:this.mergedDisabled?void 0:0,style:this.cssVars,onClick:this.handleClick,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeyup:this.handleKeyup,onKeydown:this.handleKeydown},(0,n.h)("div",{class:`${e}-switch__rail`,"aria-hidden":"true",style:l},(0,p.K9)(d,(a=>(0,p.K9)(i,(t=>a||t?(0,n.h)("div",{"aria-hidden":!0,class:`${e}-switch__children-placeholder`},(0,n.h)("div",{class:`${e}-switch__rail-placeholder`},(0,n.h)("div",{class:`${e}-switch__button-placeholder`}),a),(0,n.h)("div",{class:`${e}-switch__rail-placeholder`},(0,n.h)("div",{class:`${e}-switch__button-placeholder`}),t)):null)))),(0,n.h)("div",{class:`${e}-switch__button`},(0,p.K9)(r,(a=>(0,p.K9)(c,(t=>(0,p.K9)(m,(l=>(0,n.h)(u.Z,null,{default:()=>this.loading?(0,n.h)(b.Z,{key:"loading",clsPrefix:e,strokeWidth:20}):this.checked&&(t||a)?(0,n.h)("div",{class:`${e}-switch__button-icon`,key:t?"checked-icon":"icon"},t||a):this.checked||!l&&!a?null:(0,n.h)("div",{class:`${e}-switch__button-icon`,key:l?"unchecked-icon":"icon"},l||a)}))))))),(0,p.K9)(d,(a=>a&&(0,n.h)("div",{key:"checked",class:`${e}-switch__checked`},a))),(0,p.K9)(i,(a=>a&&(0,n.h)("div",{key:"unchecked",class:`${e}-switch__unchecked`},a))))))}})},5834:(e,a,t)=>{t.r(a),t.d(a,{default:()=>Mn});var n=t(6252),l=t(3577);const o={class:"kanban-header"},s={class:"kanban-edit-text"},d=["href"],i={class:"modal fade",id:"addUserModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},r={class:"modal-dialog modal-lg"},c={class:"modal-content"},u={class:"modal-header"},b=(0,n._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"addUserCloseButton"},[(0,n._)("span",{"aria-hidden":"true"})],-1),m={class:"modal-body"},h={key:0,class:"row"},p=(0,n._)("div",{class:"col-md-4"},[(0,n._)("strong",null,"Add Users"),(0,n._)("p",{class:"text-instructions"}," Use the following multiple select to select which users you want to add to this kanban card. "),(0,n._)("p",{class:"text-instructions"}," Please note: A user's group has to be added to the kanban card before the user can be added. ")],-1),k={class:"col-md-8"},_={key:1,class:"row"},v=(0,n._)("div",{class:"col-md-6"},[(0,n._)("strong",null,"Sorry - no results"),(0,n._)("p",{class:"text-instructions"}," This could be because "),(0,n._)("ul",{class:"text-instructions"},[(0,n._)("li",null,"There are no more users left to add"),(0,n._)("li",null," The user you are after is in a group not current added to this kanban card ")])],-1),g={class:"col-md-6 no-search"},f=["src"],C={class:"modal-footer"},y=(0,n._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),w=["disabled"];var I=t(6542),D=t(2001),L=t(3138),M=t(989),S=t(3058),x=t(5808);const U={name:"AddUserToCard",components:{Icon:I.JO,NSelect:D.Z},mixins:[S.Z,x.Z],computed:{...(0,M.Se)({cardId:"getCardId",potentialUserList:"getPotentialUserList",rootUrl:"getRootUrl",staticURL:"getStaticUrl",userLevel:"getUserLevel"})},data:()=>({userFixList:[],userModel:[]}),watch:{potentialUserList(e){void 0!==e&&(this.userFixList=e.map((e=>({value:e.id,label:`${e.username}: ${e.first_name} ${e.last_name}`}))))}},methods:{addUser(){const e=new FormData;this.userModel.forEach((a=>{e.append("user_list",a)})),this.axios.post(`${this.rootUrl}object_data/kanban_card/${this.cardId}/add_user/`,e).then((e=>{document.getElementById("addUserCloseButton").click(),this.userModel=[],this.$store.commit("updateGroupsAndUsers",{objectGroupList:e.data.object_group_list,objectUserList:e.data.object_user_list,potentialGroupList:e.data.potential_group_list,potentialUserList:e.data.potential_user_list}),new L.u_(document.getElementById("cardInformationModal")).show()})).catch((e=>{this.showErrorModal(e,"kanban card")}))}}};var $=t(3744);const R=(0,$.Z)(U,[["render",function(e,a,t,l,o,s){const d=(0,n.up)("Icon"),I=(0,n.up)("n-select");return(0,n.wg)(),(0,n.iD)("div",i,[(0,n._)("div",r,[(0,n._)("div",c,[(0,n._)("div",u,[(0,n._)("h2",null,[(0,n.Wm)(d,{icon:e.icons.userIcon},null,8,["icon"]),(0,n.Uk)(" Add User To Card ")]),b]),(0,n._)("div",m,[o.userFixList.length>0?((0,n.wg)(),(0,n.iD)("div",h,[p,(0,n._)("div",k,[(0,n.Wm)(I,{options:o.userFixList,value:o.userModel,"onUpdate:value":a[0]||(a[0]=e=>o.userModel=e),multiple:""},null,8,["options","value"])])])):((0,n.wg)(),(0,n.iD)("div",_,[v,(0,n._)("div",g,[(0,n._)("img",{src:`${e.staticURL}NearBeach/images/placeholder/questions.svg`,alt:"Sorry - there are no results"},null,8,f)])]))]),(0,n._)("div",C,[y,(0,n._)("button",{type:"button",class:"btn btn-primary",disabled:0===o.userModel.length,onClick:a[1]||(a[1]=(...e)=>s.addUser&&s.addUser(...e))}," Add User(s) ",8,w)])])])])}]]),E={class:"modal fade",id:"archiveCardsModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},B={class:"modal-dialog"},T={class:"modal-content"},j={class:"modal-header"},N=(0,n._)("h5",{class:"modal-title",id:"exampleModalLabel"}," Are you sure? ",-1),Z=(0,n._)("div",{class:"modal-body"}," Are you sure you want to archive the cards? This can not be undone. ",-1),A={class:"modal-footer"},O={name:"ArchiveCards",data:()=>({archiveCardsModal:{}}),computed:{...(0,M.Se)({allCards:"getCards",archiveDestination:"getArchiveDestination",archiveDestinationString:"getArchiveDestinationString",rootUrl:"getRootUrl"})},watch:{archiveDestinationString(e){void 0!==e&&(this.archiveCardsModal=new L.u_("#archiveCardsModal"),this.archiveCardsModal.show())}},methods:{archiveCards(){let e=this.archiveDestination.column,a=this.archiveDestination.level;const t=new FormData;this.allCards.filter((t=>parseInt(t.fields.kanban_column)===e&&parseInt(t.fields.kanban_level)===a)).forEach((e=>{t.append("kanban_card_id",e.pk)})),this.$store.commit({type:"archiveCards",column:e,level:a}),this.archiveCardsModal.hide(),this.$store.commit({type:"updateArchiveDestination",column:"",level:""}),this.axios.post(`${this.rootUrl}kanban_information/archive_kanban_cards/`,t).catch((e=>{}))},closeModal(){this.archiveCardsModal.hide(),this.$store.commit({type:"updateArchiveDestination",column:"",level:""})}}},K=(0,$.Z)(O,[["render",function(e,a,t,l,o,s){return(0,n.wg)(),(0,n.iD)("div",E,[(0,n._)("div",B,[(0,n._)("div",T,[(0,n._)("div",j,[N,(0,n._)("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:a[0]||(a[0]=(...e)=>s.closeModal&&s.closeModal(...e))})]),Z,(0,n._)("div",A,[(0,n._)("button",{type:"button",class:"btn btn-secondary",onClick:a[1]||(a[1]=(...e)=>s.closeModal&&s.closeModal(...e))}," No "),(0,n._)("button",{type:"button",class:"btn btn-primary",onClick:a[2]||(a[2]=(...e)=>s.archiveCards&&s.archiveCards(...e))}," Yes ")])])])])}]]),q={class:"modal fade",id:"blockedNotesModal",tabindex:"-1","aria-labelledby":"blockedNotesModal","aria-hidden":"true"},P={class:"modal-dialog modal-lg modal-fullscreen-lg-down"},F={class:"modal-content"},W=(0,n._)("div",{class:"modal-header"},[(0,n._)("h2",null,"Blocked Card Notes"),(0,n._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"blockedNotesModalButton"},[(0,n._)("span",{"aria-hidden":"true"})])],-1),V={class:"modal-body"},z={class:"row"},H=(0,n._)("div",{class:"col-md-4"},[(0,n._)("strong",null,"Blocked Card Notes"),(0,n._)("p",{class:"text-instructions"}," Please write a reason why this particular card is blocked at the moment. ")],-1),Y={class:"col-md-8"},G={class:"modal-footer"},J=["disabled"];var Q=t(7267);const X={name:"BlockedNotesModal",components:{editor:Q.Z},props:{},data:()=>({noteModal:""}),computed:{...(0,M.Se)({cardId:"getCardId",contentCss:"getContentCss",rootUrl:"getRootUrl",skin:"getSkin"})},methods:{addNote(){const e=new FormData;e.set("note",this.noteModal),this.axios.post(`${this.rootUrl}object_data/kanban_card/${this.cardId}/add_notes/`,e).then((()=>{this.closeModal()}))},closeModal(){this.noteModal="",document.getElementById("blockedNotesModalButton").click()}}},ee=(0,$.Z)(X,[["render",function(e,a,t,l,o,s){const d=(0,n.up)("editor");return(0,n.wg)(),(0,n.iD)("div",q,[(0,n._)("div",P,[(0,n._)("div",F,[W,(0,n._)("div",V,[(0,n._)("div",z,[H,(0,n._)("div",Y,[(0,n.Wm)(d,{init:{file_picker_types:"image",height:250,menubar:!1,plugins:["lists","image","codesample","table"],toolbar:["undo redo | formatselect | alignleft aligncenter alignright alignjustify","bold italic strikethrough underline backcolor | table | bullist numlist outdent indent | removeformat | image codesample"],skin:`${this.skin}`,content_css:`${this.contentCss}`},modelValue:o.noteModal,"onUpdate:modelValue":a[0]||(a[0]=e=>o.noteModal=e)},null,8,["init","modelValue"])])])]),(0,n._)("div",G,[(0,n._)("button",{class:"btn btn-secondary",onClick:a[1]||(a[1]=(...e)=>s.closeModal&&s.closeModal(...e))}," Close "),(0,n._)("button",{class:"btn btn-primary save-changes",onClick:a[2]||(a[2]=(...e)=>s.addNote&&s.addNote(...e)),disabled:""===o.noteModal}," Add Note ",8,J)])])])])}]]),ae={class:"kanban-header-row"},te={class:"kanban-header-row kanban-sticky-row",style:{display:"none"}},ne={class:"kanban-level-div"},le=["onClick"],oe={key:0,class:"kanban-row"},se={key:1,class:"kanban-row"},de=["id","data-level","data-column"],ie=["id","data-sort-number","data-card-id"],re=(0,n._)("br",null,null,-1);var ce=t(9980),ue=t.n(ce);const be={name:"KanbanColumn",components:{draggable:ue(),Icon:I.JO},props:{columnId:{type:Number,default:0},levelId:{type:Number,default:0},newCardInfo:{type:Array,default:()=>[]}},data:()=>({drag:!1,priorityList:["highest","high","normal","low","lowest"]}),computed:{...(0,M.Se)({allCards:"getCards",kanbanStatus:"getKanbanStatus",openCardOnLoad:"getOpenCardOnLoad",rootUrl:"getRootUrl"}),masterList(){let e=this.allCards.filter((e=>parseInt(e.fields.kanban_column)===this.columnId&&parseInt(e.fields.kanban_level)===this.levelId));return e=e.sort(((e,a)=>e.fields.kanban_card_sort_number-a.fields.kanban_card_sort_number)),e}},mixins:[x.Z],methods:{checkCardOrder(){if(0===this.masterList.length)return;const e=this.masterList.map((e=>e.fields.kanban_card_sort_number)),a=Math.min.apply(null,e),t=Math.max.apply(null,e);0===a&&t===this.masterList.length-1||(document.getElementById("sort_error").style.display="flex",this.masterList.forEach(((e,a)=>{const t=new FormData;t.set("new_card_column",this.columnId.toString()),t.set("new_card_level",this.levelId.toString()),t.set("new_card_sort_number",a.toString()),t.set("old_card_column",e.fields.kanban_column),t.set("old_card_level",e.fields.kanban_level),t.set("old_card_sort_number",e.fields.kanban_card_sort_number),t.set("card_id",e.pk),this.$store.commit({type:"updateKanbanCard",card_id:e.pk,kanban_column:this.columnId,kanban_level:this.levelId,kanban_card_sort_number:a}),this.axios.post(`${this.rootUrl}kanban_information/${e.pk}/move_card/`,t)})),document.getElementById("sort_error").style.display="")},doubleClickCard(e){const a=this.masterList.filter((a=>a.pk===e.target.dataset.cardId))[0];this.sendDataUpstream(a)},isLinkedObject(e){let a="";return null!==e.fields.project&&(a="project"),null!==e.fields.requirement&&(a="requirement"),null!==e.fields.task&&(a="task"),a},sendDataUpstream(e){const a=this.isLinkedObject(e);if(a.length>0){const t=`${this.rootUrl}${a}_information/${e.fields[a]}/`;window.open(t,"_blank").focus()}else this.$store.dispatch({type:"updateCard",cardId:e.pk,cardTitle:e.fields.kanban_card_text,cardDescription:e.fields.kanban_card_description,cardColumn:e.fields.kanban_column,cardLevel:e.fields.kanban_level,cardLink:{},cardPriority:e.fields.kanban_card_priority}),new L.u_(document.getElementById("cardInformationModal")).show()},singleClickCard(e){const a=this.masterList.filter((a=>a.pk===e))[0];this.sendDataUpstream(a)}},watch:{newCardInfo(){this.columnId===this.newCardInfo[0].fields.kanban_column&&this.levelId===this.newCardInfo[0].fields.kanban_level&&this.masterList.push(this.newCardInfo[0])}},mounted(){this.masterList.filter((e=>{const a=e.pk===this.openCardOnLoad,t=0===this.isLinkedObject(e).length;return a&&t})).length>0&&this.singleClickCard(this.openCardOnLoad)}},me=(0,$.Z)(be,[["render",function(e,a,t,o,s,d){const i=(0,n.up)("Icon");return(0,n.wg)(),(0,n.iD)("div",{class:"list-group kanban-cell",id:`kanban_cell_${t.levelId}_${t.columnId}`,"data-level":t.levelId,"data-column":t.columnId},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(d.masterList,(t=>((0,n.wg)(),(0,n.iD)("div",{class:"list-group-item",key:t.pk,id:t.pk,"data-sort-number":t.fields.kanban_card_sort_number,"data-card-id":t.pk,onDblclick:a[0]||(a[0]=e=>d.doubleClickCard(e))},[(0,n._)("div",{class:(0,l.normalizeClass)(`card-priority-line priority-${s.priorityList[t.fields.kanban_card_priority]}`)},null,2),d.isLinkedObject(t)?((0,n.wg)(),(0,n.j4)(i,{key:0,icon:e.icons.linkOut,"data-sort-number":t.fields.kanban_card_sort_number,"data-card-id":t.pk,class:"card-external-link"},null,8,["icon","data-sort-number","data-card-id"])):(0,n.kq)("v-if",!0),(0,n._)("b",null,"#"+(0,l.toDisplayString)(t.pk),1),re,(0,n.Uk)(" "+(0,l.toDisplayString)(t.fields.kanban_card_text)+" ",1),(0,n.Wm)(i,{class:"kanban-card-info-icon",icon:e.icons.infoCircle,onClick:e=>d.singleClickCard(t.pk),onDblclick:e=>d.singleClickCard(t.pk)},null,8,["icon","onClick","onDblclick"])],40,ie)))),128))],8,de)}]]),he=["id","data-sort-number","data-card-id","data-card-priority"],pe=["data-card-id","data-sort-number","data-card-priority"],ke=(0,n._)("br",null,null,-1),_e={class:"kanban-add-new-cards"},ve={name:"kanbanColumnDraggable",components:{Icon:I.JO,draggable:ue()},props:{columnId:{type:Number,default:0},columnProperty:{type:String,default:"Normal"},levelId:{type:Number,default:0},newCardInfo:{type:Array,default:()=>[]}},data:()=>({drag:!1,priorityList:["highest","high","normal","low","lowest"]}),computed:{...(0,M.Se)({allCards:"getCards",canDragCards:"getCanDragCards",kanbanStatus:"getKanbanStatus",levelCollapseStatus:"getLevelCollapseStatus",openCardOnLoad:"getOpenCardOnLoad",rootUrl:"getRootUrl"}),dragOptions:()=>({animation:200,group:"description",disabled:!1,ghostClass:"ghost"}),masterList(){return this.$store.getters.getCardsOrder(this.columnId,this.levelId)}},mixins:[x.Z],methods:{addNewKanbanCard(){const e=document.getElementById("addKanbanCardModal");e.dataset.kanbanLevel=this.levelId,e.dataset.kanbanColumn=this.columnId,new L.u_(e).show()},addNewLink(){const e=document.getElementById("newLinkModal");e.dataset.kanbanLevel=this.levelId,e.dataset.kanbanColumn=this.columnId,new L.u_(e).show()},archiveCards(){this.$store.commit({type:"updateArchiveDestination",column:this.columnId,level:this.levelId})},checkCardOrder(){if(0===this.masterList.length)return;const e=this.masterList.map((e=>e.fields.kanban_card_sort_number)),a=Math.min.apply(null,e),t=Math.max.apply(null,e);if(0===a&&t===this.masterList.length-1)return;document.getElementById("sort_error").style.display="flex";const n=new FormData;this.masterList.forEach(((e,a)=>{n.append("kanban_cards",e.pk),this.$store.commit({type:"updateKanbanCard",card_id:e.pk,kanban_card_sort_number:a})})),this.axios.post(`${this.rootUrl}kanban_information/fix_card_ordering/`,n).catch((e=>{})),document.getElementById("sort_error").style.display=""},doubleClickCard(e){const a=this.masterList.filter((a=>parseInt(a.pk)===parseInt(e.target.dataset.cardId)))[0];this.sendDataUpstream(a)},isLinkedObject(e){let a="";return null!==e.fields.project&&(a="project"),null!==e.fields.requirement&&(a="requirement"),null!==e.fields.task&&(a="task"),a},async onEnd(e){await this.$store.dispatch("kanbanCardMoved",{event:e});const a=e.to,t=e.from,n=e.item.dataset.cardId;let l=a.dataset.column,o=a.dataset.level,s=(e.newIndex,t.dataset.column),d=t.dataset.level;e.oldIndex,a.dataset.columnProperty;const i=new FormData;i.set("new_card_column",l),i.set("new_card_level",o),this.$store.getters.getCardsOrder(l,o).forEach((e=>{i.append("new_destination",e.pk)})),this.$store.getters.getCardsOrder(s,d).forEach((e=>{i.append("old_destination",e.pk)})),this.axios.post(`${this.rootUrl}kanban_information/${n}/move_card/`,i).catch((e=>{}))},sendDataUpstream(e){const a=this.isLinkedObject(e);if(a.length>0){const t=`${this.rootUrl}${a}_information/${e.fields[a]}/`;window.open(t,"_blank").focus()}else this.$store.dispatch({type:"updateCard",cardId:e.pk,cardTitle:e.fields.kanban_card_text,cardDescription:e.fields.kanban_card_description,cardColumn:e.fields.kanban_column,cardLevel:e.fields.kanban_level,cardLink:{},cardPriority:e.fields.kanban_card_priority}),new L.u_(document.getElementById("cardInformationModal")).show()},singleClickCard(e){const a=this.masterList.filter((a=>a.pk===e))[0];this.sendDataUpstream(a)}},watch:{newCardInfo(){this.columnId===this.newCardInfo[0].fields.kanban_column&&this.levelId===this.newCardInfo[0].fields.kanban_level&&this.masterList.push(this.newCardInfo[0])}},mounted(){this.checkCardOrder(),this.masterList.filter((e=>{const a=e.pk===this.openCardOnLoad,t=0===this.isLinkedObject(e).length;return a&&t})).length>0&&this.singleClickCard(this.openCardOnLoad)}},ge={name:"KanbanRow",components:{KanbanColumn:me,KanbanColumnDraggable:(0,$.Z)(ve,[["render",function(e,a,t,o,s,d){const i=(0,n.up)("Icon"),r=(0,n.up)("draggable");return e.levelCollapseStatus(t.levelId)?(0,n.kq)("v-if",!0):((0,n.wg)(),(0,n.j4)(r,{key:0,class:"list-group kanban-cell",id:`kanban_cell_${t.levelId}_${t.columnId}`,"data-level":t.levelId,"data-column":t.columnId,"data-column-property":t.columnProperty,animation:200,disabled:"Closed"===e.kanbanStatus||!e.canDragCards,group:"tasks","ghost-class":"ghost",onEnd:a[4]||(a[4]=e=>d.onEnd(e)),modelValue:d.masterList,"onUpdate:modelValue":a[5]||(a[5]=e=>d.masterList=e),"item-key":"pk"},{item:(0,n.w5)((({element:t})=>[((0,n.wg)(),(0,n.iD)("div",{class:"list-group-item",key:t.pk,id:t.pk,"data-sort-number":t.fields.kanban_card_sort_number,"data-card-id":t.pk,"data-card-priority":t.fields.kanban_card_priority,onDblclick:a[0]||(a[0]=e=>d.doubleClickCard(e))},[(0,n._)("div",{class:(0,l.normalizeClass)(`card-priority-line priority-${s.priorityList[t.fields.kanban_card_priority]}`),"data-card-id":t.pk,"data-sort-number":t.fields.kanban_card_sort_number,"data-card-priority":t.fields.kanban_card_priority},null,10,pe),d.isLinkedObject(t).length>0?((0,n.wg)(),(0,n.j4)(i,{key:0,icon:e.icons.linkOut,"data-card-id":t.pk,"data-sort-number":t.fields.kanban_card_sort_number,"data-card-priority":t.fields.kanban_card_priority,class:"card-external-link"},null,8,["icon","data-card-id","data-sort-number","data-card-priority"])):(0,n.kq)("v-if",!0),(0,n._)("b",null,"#"+(0,l.toDisplayString)(t.pk),1),ke,(0,n.Uk)(" "+(0,l.toDisplayString)(t.fields.kanban_card_text)+" ",1),(0,n.Wm)(i,{class:"kanban-card-info-icon",icon:e.icons.infoCircle,onClick:e=>d.singleClickCard(t.pk),onDblclick:e=>d.singleClickCard(t.pk)},null,8,["icon","onClick","onDblclick"])],40,he))])),footer:(0,n.w5)((()=>[(0,n._)("div",_e,["Closed"!==t.columnProperty?((0,n.wg)(),(0,n.iD)("a",{key:0,class:"kanban-link btn btn-primary",href:"javascript:void(0)",onClick:a[1]||(a[1]=(...e)=>d.addNewKanbanCard&&d.addNewKanbanCard(...e))}," New Card ")):(0,n.kq)("v-if",!0),"Closed"!==t.columnProperty?((0,n.wg)(),(0,n.iD)("a",{key:1,class:"kanban-link btn btn-warning",href:"javascript:void(0)",onClick:a[2]||(a[2]=(...e)=>d.addNewLink&&d.addNewLink(...e))}," Link Object ")):(0,n.kq)("v-if",!0),d.masterList.length>0?((0,n.wg)(),(0,n.iD)("a",{key:2,class:"kanban-link btn btn-danger",href:"javascript:void(0)",onClick:a[3]||(a[3]=(...e)=>d.archiveCards&&d.archiveCards(...e))}," Archive Cards ")):(0,n.kq)("v-if",!0)])])),_:1},8,["id","data-level","data-column","data-column-property","disabled","modelValue"]))}]])},props:{levelId:{type:Number,default:0},newCardInfo:{type:Array,default:()=>[]}},computed:{...(0,M.Se)({columnResults:"getColumnResults",userLevel:"getUserLevel"})},methods:{doubleClickedCard(e){this.$emit("double_clicked_card",e)}}},fe={name:"KanbanBoard",components:{KanbanRow:(0,$.Z)(ge,[["render",function(e,a,t,l,o,s){const d=(0,n.up)("kanban-column-draggable"),i=(0,n.up)("kanban-column");return e.userLevel>1?((0,n.wg)(),(0,n.iD)("div",oe,[(0,n.kq)(" Users can edit kanban board - can drag "),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.columnResults,(e=>((0,n.wg)(),(0,n.j4)(d,{key:e.pk,"level-id":t.levelId,"column-id":e.pk,"column-property":e.fields.kanban_column_property,"new-card-info":t.newCardInfo,onDouble_clicked_card:a[0]||(a[0]=e=>s.doubleClickedCard(e))},null,8,["level-id","column-id","column-property","new-card-info"])))),128))])):((0,n.wg)(),(0,n.iD)("div",se,[(0,n.kq)(" Read Only Users "),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.columnResults,(e=>((0,n.wg)(),(0,n.j4)(i,{key:e.pk,"level-id":t.levelId,"column-id":e.pk,"new-card-info":t.newCardInfo,onDouble_clicked_card:a[1]||(a[1]=e=>s.doubleClickedCard(e))},null,8,["level-id","column-id","new-card-info"])))),128))]))}]])},props:{kanbanBoardResults:{type:Array,default:()=>[]},newCardInfo:{type:Array,default:()=>[]}},computed:{...(0,M.Se)({columnResults:"getColumnResults",levelCardCount:"getLevelCardCount",levelResults:"getLevelResults"})},mixins:[x.Z],data:()=>({}),created(){window.addEventListener("resize",this.resizeProcedure),window.addEventListener("scroll",this.scrollProcedure)},unmounted(){window.removeEventListener("resize",this.resizeProcedure),window.removeEventListener("scroll",this.scrollProcedure)},methods:{doubleClickedCard(e){this.$emit("double_clicked_card",e)},expandLevel(e){this.$store.dispatch("updateLevelCollapse",{level_id:e})},getExpandClass(e){return this.$store.getters.getLevelCollapseStatus(e)?"kanban-expand collapsed":"kanban-expand expanded"},resizeProcedure(){const e=2*(this.columnResults.length-1),a=400*this.columnResults.length+e,t=document.getElementsByClassName("kanban-container")[0];if(void 0===t)return;const n=t.clientWidth;if(a<n){const e=document.getElementsByClassName("kanban-edit-text")[0],t=document.getElementsByClassName("kanban-level-div");Array.from(t).forEach((e=>{e.style=`max-width: ${a}px;`})),e.style=`max-width: ${a}px`}else{const e=t.scrollWidth,a=document.getElementsByClassName("kanban-edit-text")[0];let n=document.getElementsByClassName("kanban-level-div");Array.from(n).forEach((a=>{a.style=`width: ${e}px;`})),a.style=`max-width: ${e}px`}},scrollProcedure(){const e=document.getElementsByClassName("kanban-sticky-row")[0],a=document.getElementsByClassName("kanban-container")[0];e.scrollLeft=a.scrollLeft;const t=document.getElementById("kanban_container").scrollTop;e.style.display=t<90?"none":""}},mounted(){this.$nextTick((()=>{this.resizeProcedure()})),this.$store.commit({type:"updateKanbanStatus",kanbanStatus:this.kanbanBoardResults[0].fields.kanban_board_status})}},Ce=(0,$.Z)(fe,[["render",function(e,a,t,o,s,d){const i=(0,n.up)("kanban-row");return(0,n.wg)(),(0,n.iD)("div",{id:"kanban_container",class:"kanban-container",onScroll:a[1]||(a[1]=(...e)=>d.scrollProcedure&&d.scrollProcedure(...e))},[(0,n.kq)(" Render out the header "),(0,n._)("div",ae,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.columnResults,(e=>((0,n.wg)(),(0,n.iD)("div",{class:"kanban-column-header",key:e.pk},(0,l.toDisplayString)(e.fields.kanban_column_name),1)))),128))]),(0,n.kq)(" Render out the STICKY header "),(0,n._)("div",te,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.columnResults,(e=>((0,n.wg)(),(0,n.iD)("div",{class:"kanban-column-header",key:e.pk},(0,l.toDisplayString)(e.fields.kanban_column_name),1)))),128))]),(0,n.kq)(" Render each row "),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.levelResults,(o=>((0,n.wg)(),(0,n.iD)("div",{key:o.pk},[(0,n.kq)(" CREATE THE LEVEL HEADER "),(0,n._)("div",ne,[(0,n._)("span",{class:(0,l.normalizeClass)(d.getExpandClass(o.pk)),onClick:e=>d.expandLevel(o.pk)},null,10,le),(0,n._)("span",null,(0,l.toDisplayString)(o.fields.kanban_level_name)+" - ["+(0,l.toDisplayString)(e.levelCardCount(o.pk))+"] ",1)]),(0,n.kq)(" RENDER THE CELLS "),(0,n.Wm)(i,{"level-id":o.pk,"new-card-info":t.newCardInfo,onDouble_clicked_card:a[0]||(a[0]=e=>d.doubleClickedCard(e))},null,8,["level-id","new-card-info"])])))),128))],32)}]]);var ye=t(9963);const we=["data-kanban-level","data-kanban-column"],Ie={class:"modal-dialog modal-xl modal-fullscreen-xl-down"},De={class:"modal-content"},Le={class:"modal-header"},Me=(0,n._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"addKanbanCardCloseButton"},null,-1),Se={class:"modal-body"},xe={class:"row"},Ue=(0,n._)("div",{class:"col-md-4"},[(0,n._)("strong",null,"Please note"),(0,n._)("p",{class:"text-instructions"}," The card names can not be the same as something that already exists on the board. ")],-1),$e={class:"col-md-8"},Re=(0,n._)("label",null,"Kanban Card Text",-1),Ee={class:"row"},Be=(0,n._)("div",{class:"col-md-4"},[(0,n._)("strong",null,"Card Priority"),(0,n._)("p",{class:"text-instructions"}," Please select the apprioriate card priority. ")],-1),Te={class:"col-md-8"},je=(0,n._)("label",null,"Card Priority",-1),Ne={class:"row"},Ze=(0,n._)("div",{class:"col-md-4"},[(0,n._)("strong",null,"Card Description"),(0,n._)("p",{class:"text-instructions"},' Fill out a detailed description for the card, then click on the "Update Card" button to update the card. ')],-1),Ae={class:"col-md-8"},Oe={class:"modal-footer"},Ke=(0,n._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),qe=["disabled"];var Pe=t(2299);const Fe={name:"NewKanbanCard",components:{editor:Q.Z,Icon:I.JO,NSelect:D.Z},props:{columnResults:{type:Array,default:()=>[]},kanbanCardResults:{type:Array,default:()=>[]},levelResults:{type:Array,default:()=>[]},kanbanBoardResults:{type:Array,default:()=>[]}},mixins:[x.Z,Pe.Z],data:()=>({disableAddButton:!0,kanbanCardDescriptionModel:"",kanbanCardTextModel:"",kanbanCardPriorityModal:2,listPriority:[{label:"Highest",value:0},{label:"High",value:1},{label:"Normal",value:2},{label:"Low",value:3},{label:"Lowest",value:4}]}),computed:{...(0,M.Se)({contentCss:"getContentCss",rootUrl:"getRootUrl",skin:"getSkin"})},methods:{addKanbanCard(){const e=document.getElementById("addKanbanCardModal"),a=new FormData;a.set("kanban_card_text",this.kanbanCardTextModel),a.set("kanban_card_description",this.kanbanCardDescriptionModel),a.set("kanban_level",e.dataset.kanbanLevel),a.set("kanban_column",e.dataset.kanbanColumn),a.set("kanban_card_priority",this.kanbanCardPriorityModal),this.axios.post(`${this.rootUrl}kanban_information/${this.kanbanBoardResults[0].pk}/new_card/`,a).then((e=>{this.$emit("new_card",e.data),this.kanbanCardTextModel="",this.kanbanCardDescriptionModel="",document.getElementById("addKanbanCardCloseButton").click()})).catch((e=>{}))}},watch:{kanbanCardTextModel(){this.disableAddButton=!1,0===this.kanbanCardTextModel.length&&(this.disableAddButton=!0),this.kanbanCardResults.filter((e=>e.fields.kanban_card_text===this.kanbanCardTextModel)).length>0&&(this.disableAddButton=!0),0!==this.columnResults.length&&0!==this.levelResults.length||(this.disableAddButton=!0)}}},We=(0,$.Z)(Fe,[["render",function(e,a,t,l,o,s){const d=(0,n.up)("Icon"),i=(0,n.up)("n-select"),r=(0,n.up)("editor");return(0,n.wg)(),(0,n.iD)("div",{class:"modal fade",id:"addKanbanCardModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"addKanbanCardModalLabel","aria-hidden":"true","data-kanban-level":t.levelResults[0].pk,"data-kanban-column":t.columnResults[0].pk},[(0,n._)("div",Ie,[(0,n._)("div",De,[(0,n._)("div",Le,[(0,n._)("h2",null,[(0,n.Wm)(d,{icon:e.icons.cardChecklist},null,8,["icon"]),(0,n.Uk)(" Add Kanban Card Wizard ")]),Me]),(0,n._)("div",Se,[(0,n._)("div",xe,[Ue,(0,n._)("div",$e,[Re,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>o.kanbanCardTextModel=e),onKeydown:a[1]||(a[1]=(0,ye.withKeys)(((...e)=>s.addKanbanCard&&s.addKanbanCard(...e)),["enter"])),class:"form-control"},null,544),[[ye.vModelText,o.kanbanCardTextModel]])])]),(0,n.kq)(" CARD PRIORITY "),(0,n._)("div",Ee,[Be,(0,n._)("div",Te,[je,(0,n.Wm)(i,{options:o.listPriority,value:o.kanbanCardPriorityModal,"onUpdate:value":a[2]||(a[2]=e=>o.kanbanCardPriorityModal=e)},null,8,["options","value"])])]),(0,n.kq)(" CARD DESCRIPTION "),(0,n._)("div",Ne,[Ze,(0,n._)("div",Ae,[(0,n.Wm)(r,{init:{file_picker_types:"image",height:300,images_upload_handler:e.uploadImage,menubar:!1,paste_data_images:!0,plugins:["lists","image","codesample","table"],toolbar:["undo redo | formatselect | alignleft aligncenter alignright alignjustify","bold italic strikethrough underline backcolor | table | bullist numlist outdent indent | removeformat | image codesample"],skin:`${this.skin}`,content_css:`${this.contentCss}`},modelValue:o.kanbanCardDescriptionModel,"onUpdate:modelValue":a[3]||(a[3]=e=>o.kanbanCardDescriptionModel=e)},null,8,["init","modelValue"])])])]),(0,n._)("div",Oe,[Ke,(0,n._)("button",{type:"button",class:"btn btn-primary",onClick:a[4]||(a[4]=(...e)=>s.addKanbanCard&&s.addKanbanCard(...e)),disabled:o.disableAddButton}," Add Card ",8,qe)])])])],8,we)}]]),Ve={class:"modal fade",id:"cardInformationModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},ze={class:"modal-dialog modal-xl modal-fullscreen-xl-down"},He={class:"modal-content"},Ye={class:"modal-header"},Ge=(0,n._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"cardInformationModalCloseButton"},[(0,n._)("span",{"aria-hidden":"true"})],-1),Je=(0,n._)("br",null,null,-1),Qe={class:"modal-body"},Xe=(0,n._)("ul",{id:"card_information_tabs",class:"nav nav-tabs",role:"tablist"},[(0,n._)("li",{class:"nav-item",role:"presentation"},[(0,n._)("button",{class:"nav-link active",id:"details-tab","data-bs-toggle":"tab","data-bs-target":"#card_details",type:"button",role:"tab","aria-controls":"home","aria-selected":"true"}," Details ")]),(0,n._)("li",{class:"nav-item",role:"presentation"},[(0,n._)("button",{class:"nav-link",id:"description-tab","data-bs-toggle":"tab","data-bs-target":"#card_description",type:"button",role:"tab","aria-controls":"profile","aria-selected":"false"}," Description ")]),(0,n._)("li",{class:"nav-item",role:"presentation"},[(0,n._)("button",{class:"nav-link",id:"notes-tab","data-bs-toggle":"tab","data-bs-target":"#card_notes",type:"button",role:"tab","aria-controls":"contact","aria-selected":"false"}," Notes ")]),(0,n._)("li",{class:"nav-item",role:"presentation"},[(0,n._)("button",{class:"nav-link",id:"users-tab","data-bs-toggle":"tab","data-bs-target":"#user_permissions",type:"button",role:"tab","aria-controls":"contact","aria-selected":"false"}," Users ")]),(0,n._)("li",{class:"nav-item",role:"presentation"},[(0,n._)("button",{class:"nav-link",id:"downloads-tab","data-bs-toggle":"tab","data-bs-target":"#downloads",type:"button",role:"tab","aria-controls":"contact","aria-selected":"false"}," Downloads ")])],-1),ea=(0,n._)("hr",null,null,-1),aa={class:"tab-content",id:"myTabContent"},ta={class:"tab-pane fade show active",id:"card_details",role:"tabpanel","aria-labelledby":"details-tab"},na={class:"tab-pane fade",id:"card_description",role:"tabpanel","aria-labelledby":"description-tab"},la={class:"tab-pane fade",id:"card_notes",role:"tabpanel","aria-labelledby":"notes-tab"},oa={class:"tab-pane fade",id:"user_permissions",role:"tabpanel","aria-labelledby":"user-tab"},sa={class:"tab-pane fade",id:"downloads",role:"tabpanel","aria-labelledby":"user-tab"},da={key:0,class:"row link-to-object"},ia=(0,n._)("strong",null,"Object Link: ",-1),ra=["href"],ca={key:1},ua={class:"row"},ba=(0,n._)("div",{class:"col-md-4"},[(0,n._)("strong",null,"Card Title"),(0,n._)("p",{class:"text-instructions"},' Write an appropriate name for the kanban card. To update click on the "Update" button. ')],-1),ma={class:"col-md-8"},ha=(0,n._)("label",null,"Card Title",-1),pa=(0,n._)("hr",null,null,-1),ka={class:"row"},_a=(0,n._)("div",{class:"col-md-4"},[(0,n._)("strong",null,"Card Priority"),(0,n._)("p",{class:"text-instructions"}," Define what the priority of the card is. ")],-1),va={class:"col-md-4"},ga=(0,n._)("label",null,"Card Priority",-1),fa=(0,n._)("hr",null,null,-1),Ca={class:"row"},ya=(0,n._)("div",{class:"col-md-4"},[(0,n._)("strong",null,"Card Location"),(0,n._)("p",{class:"text-instructions"}," Select the appropriate location for this card. ")],-1),wa={class:"col-md-8"},Ia={class:"row"},Da={class:"col-md-6 mt-4"},La=(0,n._)("label",null,"Card Column",-1),Ma={class:"col-md-6 mt-4"},Sa=(0,n._)("label",null,"Card Level",-1),xa={key:2},Ua={key:3,class:"row"},$a={class:"col-md-12"},Ra={name:"CardDetails",components:{NSelect:D.Z},data:()=>({listPriority:[{label:"Highest",value:0},{label:"High",value:1},{label:"Normal",value:2},{label:"Low",value:3},{label:"Lowest",value:4}],tempModel:""}),computed:{...(0,M.Se)({cardId:"getCardId",cardLink:"getCardLink",kanbanStatus:"getKanbanStatus",listColumns:"getListColumns",listLevels:"getListLevels",userLevel:"getUserLevel"}),cardColumn:{get(){return this.$store.state.card.cardColumn},set(e){this.$store.commit({type:"updateValue",field:"cardColumn",value:e})}},cardLevel:{get(){return this.$store.state.card.cardLevel},set(e){this.$store.commit({type:"updateValue",field:"cardLevel",value:e})}},cardPriority:{get(){return this.$store.state.card.cardPriority},set(e){this.$store.commit({type:"updateValue",field:"cardPriority",value:e})}},cardTitle:{get(){return this.$store.state.card.cardTitle},set(e){this.$store.commit({type:"updateValue",field:"cardTitle",value:e})}}},methods:{archiveCard(){document.getElementById("cardInformationModalCloseButton").click(),new L.u_("#confirmCardArchiveModal").show()},closeModal(){document.getElementById("cardInformationModalCloseButton").click()},async differentDestination(e,a){const t=this.$store.getters.getCardsOrder(this.cardColumn,this.cardLevel).length,n={to:{dataset:{column:this.cardColumn,level:this.cardLevel}},from:{dataset:{column:a.fields.kanban_column,level:a.fields.kanban_level}},item:{dataset:{cardId:this.cardId,cardPriority:this.cardPriority}},newIndex:t};await this.$store.dispatch("kanbanCardMoved",{event:n});const l=this.$store.getters.getCardsOrder(this.cardColumn,this.cardLevel),o=this.$store.getters.getCardsOrder(a.fields.kanban_column,a.fields.kanban_level).filter((e=>parseInt(e.pk)!==parseInt(this.cardId)));this.$emit("update_card",{close_modal:e,new_destination:l,old_destination:o})},sameDestination(e){this.$store.commit({type:"updateKanbanCard",card_id:this.cardId,kanban_card_text:this.cardTitle,kanban_card_priority:this.cardPriority}),this.$emit("update_card",{close_modal:e})},updateCard(e){const a=this.$store.getters.getCard(this.cardId),t=parseInt(this.cardColumn)===parseInt(a.fields.kanban_column),n=parseInt(this.cardLevel)===parseInt(a.fields.kanban_level);t&&n?this.sameDestination(e):this.differentDestination(e,a)}}},Ea=(0,$.Z)(Ra,[["render",function(e,a,t,o,s,d){const i=(0,n.up)("n-select");return(0,n.wg)(),(0,n.iD)("div",null,[void 0!==e.cardLink.id&&null!==e.cardLink.id?((0,n.wg)(),(0,n.iD)("div",da,[ia,(0,n._)("a",{href:e.cardLink.hyperlink,target:"_blank",rel:"noopener noreferrer"},(0,l.toDisplayString)(e.cardLink.type)+" - "+(0,l.toDisplayString)(e.cardLink.id),9,ra)])):(0,n.kq)("v-if",!0),void 0!==e.cardLink.id&&null!==e.cardLink.id?((0,n.wg)(),(0,n.iD)("hr",ca)):(0,n.kq)("v-if",!0),(0,n.kq)(" Card Text "),(0,n._)("div",ua,[ba,(0,n._)("div",ma,[ha,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>d.cardTitle=e),class:"form-control"},null,512),[[ye.vModelText,d.cardTitle]])])]),pa,(0,n._)("div",ka,[_a,(0,n._)("div",va,[ga,(0,n.Wm)(i,{options:s.listPriority,value:d.cardPriority,"onUpdate:value":a[1]||(a[1]=e=>d.cardPriority=e),disabled:"Closed"===e.kanbanStatus},null,8,["options","value","disabled"])])]),fa,(0,n.kq)(" CARD LOCATION "),(0,n._)("div",Ca,[ya,(0,n._)("div",wa,[(0,n._)("div",Ia,[(0,n._)("div",Da,[La,(0,n.Wm)(i,{options:e.listColumns,label:"column",value:d.cardColumn,"onUpdate:value":a[2]||(a[2]=e=>d.cardColumn=e),disabled:"Closed"===e.kanbanStatus},null,8,["options","value","disabled"])]),(0,n._)("div",Ma,[Sa,(0,n.Wm)(i,{options:e.listLevels,label:"level",value:d.cardLevel,"onUpdate:value":a[3]||(a[3]=e=>d.cardLevel=e),disabled:"Closed"===e.kanbanStatus},null,8,["options","value","disabled"])])])])]),e.userLevel>1?((0,n.wg)(),(0,n.iD)("hr",xa)):(0,n.kq)("v-if",!0),e.userLevel>1?((0,n.wg)(),(0,n.iD)("div",Ua,[(0,n._)("div",$a,[(0,n._)("button",{class:"btn btn-warning",onClick:a[4]||(a[4]=(...e)=>d.closeModal&&d.closeModal(...e))}," Close & Discard Changes "),"Closed"!==e.kanbanStatus?((0,n.wg)(),(0,n.iD)("button",{key:0,class:"btn btn-danger archive-card",onClick:a[5]||(a[5]=(...e)=>d.archiveCard&&d.archiveCard(...e))}," Archive Card ")):(0,n.kq)("v-if",!0),"Closed"!==e.kanbanStatus?((0,n.wg)(),(0,n.iD)("button",{key:1,class:"btn btn-primary save-changes",onClick:a[6]||(a[6]=e=>d.updateCard(!0))}," Save & Close ")):(0,n.kq)("v-if",!0),"Closed"!==e.kanbanStatus?((0,n.wg)(),(0,n.iD)("button",{key:2,class:"btn btn-success save-changes",onClick:a[7]||(a[7]=e=>d.updateCard(!1))}," Save & Continue ")):(0,n.kq)("v-if",!0)])])):(0,n.kq)("v-if",!0)])}]]),Ba={key:0,class:"row"},Ta=(0,n._)("div",{class:"col-md-4"},[(0,n._)("strong",null,"Notes"),(0,n._)("p",{class:"text-instructions"},' To add a note - type your note in the Note Box and hit the "Submit Note" button. ')],-1),ja={class:"col-md-8"},Na=(0,n._)("label",null,"Note Box",-1),Za={key:1},Aa={key:2,class:"row"},Oa={class:"col-md-12"},Ka=["disabled"],qa=(0,n._)("hr",null,null,-1);var Pa=t(2857);const Fa={name:"CardNotes",components:{editor:Q.Z,ListNotes:Pa.Z},props:{},data:()=>({cardNoteModel:""}),computed:{...(0,M.Se)({cardNotes:"getCardNotes",contentCss:"getContentCss",kanbanStatus:"getKanbanStatus",rootUrl:"getRootUrl",skin:"getSkin",userLevel:"getUserLevel"})},methods:{addNote(){const e=new FormData;e.set("note",this.cardNoteModel),this.axios.post(`${this.rootUrl}object_data/kanban_card/${this.$store.state.card.cardId}/add_notes/`,e).then((e=>{this.$store.commit({type:"appendNote",newNote:e.data[0]}),this.cardNoteModel=""})).catch((e=>{}))},closeModal(){document.getElementById("cardInformationModalCloseButton").click()}}},Wa=(0,$.Z)(Fa,[["render",function(e,a,t,l,o,s){const d=(0,n.up)("editor"),i=(0,n.up)("list-notes");return(0,n.wg)(),(0,n.iD)("div",null,[e.userLevel>1?((0,n.wg)(),(0,n.iD)("div",Ba,[Ta,(0,n._)("div",ja,[Na,(0,n.Wm)(d,{init:{height:250,menubar:!1,plugins:["lists","codesample","table"],toolbar:["undo redo | formatselect | alignleft aligncenter alignright alignjustify","bold italic strikethrough underline backcolor | table | bullist numlist outdent indent | removeformat | image codesample"],skin:`${this.skin}`,content_css:`${this.contentCss}`},modelValue:o.cardNoteModel,"onUpdate:modelValue":a[0]||(a[0]=e=>o.cardNoteModel=e),disabled:"Closed"===e.kanbanStatus},null,8,["init","modelValue","disabled"])])])):(0,n.kq)("v-if",!0),e.userLevel>1?((0,n.wg)(),(0,n.iD)("hr",Za)):(0,n.kq)("v-if",!0),e.userLevel>1?((0,n.wg)(),(0,n.iD)("div",Aa,[(0,n._)("div",Oa,[(0,n._)("button",{class:"btn btn-secondary",onClick:a[1]||(a[1]=(...e)=>s.closeModal&&s.closeModal(...e))}," Close "),(0,n._)("button",{class:"btn btn-primary save-changes",onClick:a[2]||(a[2]=(...e)=>s.addNote&&s.addNote(...e)),disabled:""===o.cardNoteModel}," Add Note ",8,Ka)])])):(0,n.kq)("v-if",!0),qa,(0,n.kq)(" NOTE HISTORY "),(0,n.Wm)(i,{"note-history-results":e.cardNotes,destination:"card"},null,8,["note-history-results"])])}]]),Va={class:"row"},za=(0,n._)("div",{class:"col-md-4"},[(0,n._)("strong",null,"Card Description"),(0,n._)("p",{class:"text-instructions"},' Fill out a detailed description for the card, then click on the "Update Card" button to update the card. ')],-1),Ha={class:"col-md-8"},Ya=(0,n._)("hr",null,null,-1),Ga={key:0,class:"row"},Ja={class:"col-md-12"},Qa={name:"CardDescription",components:{editor:Q.Z},props:{},data:()=>({}),computed:{...(0,M.Se)({contentCss:"getContentCss",kanbanStatus:"getKanbanStatus",skin:"getSkin",userLevel:"getUserLevel"}),cardDescription:{get(){return this.$store.state.card.cardDescription},set(e){this.$store.commit("updateValue",{field:"cardDescription",value:e})}}},mixins:[Pe.Z],methods:{closeModal(){document.getElementById("cardInformationModalCloseButton").click()},updateCard(e){this.$emit("update_card",{close_modal:e})}}},Xa=(0,$.Z)(Qa,[["render",function(e,a,t,l,o,s){const d=(0,n.up)("editor");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("div",Va,[za,(0,n._)("div",Ha,[(0,n.Wm)(d,{init:{file_picker_types:"image",height:300,images_upload_handler:e.uploadImage,menubar:!1,paste_data_images:!0,plugins:["lists","image","codesample","table"],toolbar:["undo redo | formatselect | alignleft aligncenter alignright alignjustify","bold italic strikethrough underline backcolor | table | bullist numlist outdent indent | removeformat | image codesample"],skin:`${this.skin}`,content_css:`${this.contentCss}`},modelValue:s.cardDescription,"onUpdate:modelValue":a[0]||(a[0]=e=>s.cardDescription=e),disabled:"Closed"===e.kanbanStatus},null,8,["init","modelValue","disabled"])])]),Ya,e.userLevel>1?((0,n.wg)(),(0,n.iD)("div",Ga,[(0,n._)("div",Ja,[(0,n._)("button",{class:"btn btn-warning",onClick:a[1]||(a[1]=(...e)=>s.closeModal&&s.closeModal(...e))}," Close & Discard Changes "),"Closed"!==e.kanbanStatus?((0,n.wg)(),(0,n.iD)("button",{key:0,class:"btn btn-primary save-changes",onClick:a[2]||(a[2]=e=>s.updateCard(!0))}," Save & Close ")):(0,n.kq)("v-if",!0),"Closed"!==e.kanbanStatus?((0,n.wg)(),(0,n.iD)("button",{key:1,class:"btn btn-success save-changes",onClick:a[3]||(a[3]=e=>s.updateCard(!1))}," Save & Continue ")):(0,n.kq)("v-if",!0)])])):(0,n.kq)("v-if",!0)])}]]),et={key:0,class:"alert alert-secondary"},at={key:1},tt={class:"table"},nt=(0,n._)("td",{scope:"col"},"Username",-1),lt=(0,n._)("td",{scope:"col"},"Name",-1),ot={key:0,scope:"col"},st={key:0},dt={key:2,class:"row"},it={class:"col-md-12"},rt={name:"CardUsers",components:{Icon:I.JO},computed:{...(0,M.Se)({cardId:"getCardId",kanbanBoardStatus:"getKanbanStatus",locationId:"getLocationId",rootUrl:"getRootUrl",userLevel:"getUserLevel",objectUserList:"getObjectUserList"})},mixins:[x.Z],methods:{addUser(){document.getElementById("cardInformationModalCloseButton").click(),new L.u_("#addUserModal").show()},removeUser(e){const a=new FormData;a.set("username",e),this.axios.post(`${this.rootUrl}object_data/kanban_card/${this.locationId}/remove_user/`,a).then((e=>{this.$store.commit("updateGroupsAndUsers",{objectGroupList:e.data.object_group_list,objectUserList:e.data.object_user_list,potentialGroupList:e.data.potential_group_list,potentialUserList:e.data.potential_user_list})}))}}},ct=(0,$.Z)(rt,[["render",function(e,a,t,o,s,d){const i=(0,n.up)("Icon");return(0,n.wg)(),(0,n.iD)(n.HY,null,[0===e.objectUserList.length?((0,n.wg)(),(0,n.iD)("div",et," Sorry, there are no users currently assigned to this card. ")):((0,n.wg)(),(0,n.iD)("div",at,[(0,n._)("table",tt,[(0,n._)("thead",null,[(0,n._)("tr",null,[nt,lt,4===e.userLevel?((0,n.wg)(),(0,n.iD)("td",ot," Delete ")):(0,n.kq)("v-if",!0)])]),(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.objectUserList,(a=>((0,n.wg)(),(0,n.iD)("tr",{key:a.id},[(0,n._)("td",null,(0,l.toDisplayString)(a.id)+" - "+(0,l.toDisplayString)(a.username),1),(0,n._)("td",null,(0,l.toDisplayString)(a.first_name)+" "+(0,l.toDisplayString)(a.last_name),1),e.userLevel>=2?((0,n.wg)(),(0,n.iD)("td",st,[(0,n.Wm)(i,{icon:e.icons.trashCan,onClick:e=>d.removeUser(a.username)},null,8,["icon","onClick"])])):(0,n.kq)("v-if",!0)])))),128))])])])),e.userLevel>1&&"Closed"!==e.kanbanBoardStatus?((0,n.wg)(),(0,n.iD)("div",dt,[(0,n._)("div",it,[(0,n._)("button",{class:"btn btn-primary",onClick:a[0]||(a[0]=(...e)=>d.addUser&&d.addUser(...e))}," Add User ")])])):(0,n.kq)("v-if",!0)],64)}]]);var ut=t(4145),bt=t(9586);const mt={name:"CardInformation",components:{UploadDocumentWizard:bt.Z,CardDescription:Xa,CardDetails:Ea,CardNotes:Wa,CardUsers:ct,DocumentsModule:ut.Z,Icon:I.JO},mixins:[x.Z],data:()=>({cardDescriptionModel:"",cardNoteModel:"",cardTitleModel:"",noteHistoryResults:[]}),computed:{...(0,M.Se)({cardId:"getCardId",kanbanStatus:"getKanbanStatus",rootUrl:"getRootUrl"})},methods:{updateCard(e){this.$store.dispatch("newToast",{header:"Updating Current Card",message:"Please wait - we are updating the card's information",extra_classes:"bg-warning",unique_type:"update-card",delay:0});const a=this.$store.getters.getAllCardData,t=new FormData;t.set("kanban_card_text",a.cardTitle),t.set("kanban_card_description",a.cardDescription),t.set("kanban_level",a.cardLevel),t.set("kanban_column",a.cardColumn),t.set("kanban_card_id",a.cardId),t.set("kanban_card_priority",a.cardPriority),void 0!==e.new_destination&&e.new_destination.forEach((e=>{t.append("new_destination",e.pk)})),void 0!==e.old_destination&&e.old_destination.forEach((e=>{t.append("old_destination",e.pk)})),this.axios.post(`${this.rootUrl}kanban_information/update_card/`,t).then((()=>{this.$emit("update_card",{kanban_card_id:a.cardId,kanban_card_text:a.cardTitle,kanban_card_description:a.cardDescriptionModel}),this.$store.dispatch("newToast",{header:"Card successfully updated",message:"Your card has successfully update",extra_classes:"bg-success",unique_type:"update-card"}),e.close_modal&&document.getElementById("cardInformationModalCloseButton").click()})).catch((e=>{this.$store.dispatch("newToast",{header:"Card failed to updated",message:`Sorry your card failed to update - error -> ${e}`,extra_classes:"bg-danger",delay:0,unique_type:"update-card"})}))}}},ht=(0,$.Z)(mt,[["render",function(e,a,t,o,s,d){const i=(0,n.up)("Icon"),r=(0,n.up)("card-details"),c=(0,n.up)("card-description"),u=(0,n.up)("card-notes"),b=(0,n.up)("card-users"),m=(0,n.up)("documents-module");return(0,n.wg)(),(0,n.iD)("div",Ve,[(0,n._)("div",ze,[(0,n._)("div",He,[(0,n._)("div",Ye,[(0,n._)("h2",null,[(0,n.Wm)(i,{icon:e.icons.usersIcon},null,8,["icon"]),(0,n.Uk)(" Card Information - "+(0,l.toDisplayString)(e.cardId),1)]),Ge,Je]),(0,n._)("div",Qe,[(0,n.kq)(" TAB MENU "),Xe,ea,(0,n.kq)(" CONTENT OF TABS "),(0,n._)("div",aa,[(0,n._)("div",ta,[(0,n.Wm)(r,{onUpdate_card:a[0]||(a[0]=e=>d.updateCard(e))})]),(0,n._)("div",na,[(0,n.Wm)(c,{onUpdate_card:a[1]||(a[1]=e=>d.updateCard(e))})]),(0,n._)("div",la,[(0,n.Wm)(u)]),(0,n._)("div",oa,[(0,n.Wm)(b)]),(0,n._)("div",sa,[(0,n.Wm)(m,{"override-destination":"kanban_card","override-location-id":e.cardId,"read-only":"Closed"===e.kanbanStatus},null,8,["override-location-id","read-only"])])])])])])])}]]),pt=["data-kanban-level","data-kanban-column"],kt={class:"modal-dialog modal-lg modal-fullscreen-lg-down"},_t={class:"modal-content"},vt={class:"modal-header"},gt=(0,n._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"requirementLinkCloseButton"},[(0,n._)("span",{"aria-hidden":"true"})],-1),ft={class:"modal-body"},Ct={class:"row"},yt=(0,n._)("div",{class:"col-md-4"},[(0,n._)("strong",null,"Object Selector"),(0,n._)("p",{class:"text-instructions"}," Please select which object you would like to link to this requirement. ")],-1),wt={class:"col-md-8"},It={key:1,class:"alert alert-success"},Dt=(0,n._)("hr",null,null,-1),Lt={class:"row"},Mt=(0,n._)("div",{class:"col-md-4"},[(0,n._)("strong",null,"Select Links"),(0,n._)("p",{class:"text-instructions"}," Please select which of the objects you want to connect to this requirement. ")],-1),St={class:"col-md-8"},xt={key:0,id:"link_wizard_results"},Ut=["src"],$t={key:1,class:"alert alert-warning"},Rt={key:2,class:"form-group"},Et=(0,n._)("label",null,"Search Terms",-1),Bt=(0,n._)("br",null,null,-1),Tt={key:3,class:"table"},jt=(0,n._)("td",null,"Status",-1),Nt={key:0},Zt={class:"form-check"},At=["value","id"],Ot=["for"],Kt=(0,n._)("div",{class:"spacer"},null,-1),qt={class:"small-text"},Pt={key:1},Ft={class:"form-check"},Wt=["value","id"],Vt=["for"],zt=(0,n._)("div",{class:"spacer"},null,-1),Ht={class:"small-text"},Yt={key:2},Gt={class:"form-check"},Jt=["value","id"],Qt=["for"],Xt=(0,n._)("div",{class:"spacer"},null,-1),en={class:"small-text"},an={class:"modal-footer"},tn=(0,n._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),nn=["disabled"],ln={name:"NewKanbanLinkWizard",components:{Icon:I.JO,NSelect:D.Z},props:{columnResults:{type:Array,default:()=>[]},levelResults:{type:Array,default:()=>[]},locationId:{type:Number,default:0}},computed:{...(0,M.Se)({rootUrl:"getRootUrl",staticUrl:"getStaticUrl"})},mixins:[S.Z,x.Z],data:()=>({isSearching:!1,linkModel:[],objectModel:null,objectFilteredResults:[],objectResults:[],objectSelection:[{value:"Project",label:"Project"},{value:"Requirement",label:"Requirement"},{value:"Task",label:"Task"}],searchTermModel:""}),methods:{saveLinks(){const e=new FormData,a=document.getElementById("newLinkModal");e.set(`${this.objectModel.toLowerCase()}`,this.linkModel),e.set("kanban_level",a.dataset.kanbanLevel),e.set("kanban_column",a.dataset.kanbanColumn),this.axios.post(`${this.rootUrl}kanban_information/${this.locationId}/${this.objectModel.toLowerCase()}/add_link/`,e).then((e=>{this.$emit("new_card",e.data),this.objectModel=null,document.getElementById("requirementLinkCloseButton").click()}))}},watch:{objectModel(){this.linkModel=[],null!==this.objectModel?(this.isSearching=!0,this.axios.post(`${this.rootUrl}kanban_information/${this.locationId}/${this.objectModel}/link_list/`).then((e=>{this.objectResults=e.data,this.objectFilteredResults=e.data,this.isSearching=!1,this.searchTermModel=""})).catch((e=>{this.showErrorModal(e,"kanban")}))):this.isSearching=!1},searchTermModel(){""!==this.searchTermModel&&null!==this.searchTermModel?this.objectFilteredResults=this.objectResults.filter((e=>{let a="";return a=void 0!==e.fields.project_description?e.fields.project_description.toLowerCase():e.fields.task_short_description.toLowerCase(),a.includes(this.searchTermModel.toLowerCase())})):this.objectFilteredResults=this.objectResults}}},on=(0,$.Z)(ln,[["render",function(e,a,t,o,s,d){const i=(0,n.up)("Icon"),r=(0,n.up)("n-select");return(0,n.wg)(),(0,n.iD)("div",{class:"modal fade",id:"newLinkModal",tabindex:"-1","aria-labelledby":"kanbanLinkModal","aria-hidden":"true","data-kanban-level":t.levelResults[0].pk,"data-kanban-column":t.columnResults[0].pk},[(0,n._)("div",kt,[(0,n._)("div",_t,[(0,n._)("div",vt,[(0,n._)("h2",null,[(0,n.Wm)(i,{icon:e.icons.linkOut},null,8,["icon"]),(0,n.Uk)(" New Kanban Link Wizard ")]),gt]),(0,n._)("div",ft,[(0,n.kq)(" CHOOSING A OBJECT TYPE "),(0,n._)("div",Ct,[yt,(0,n._)("div",wt,[s.isSearching?((0,n.wg)(),(0,n.iD)("div",It," Searching for "+(0,l.toDisplayString)(s.objectModel)+"s ",1)):((0,n.wg)(),(0,n.j4)(r,{key:0,options:s.objectSelection,value:s.objectModel,"onUpdate:value":a[0]||(a[0]=e=>s.objectModel=e),class:"object-selection"},null,8,["options","value"]))])]),Dt,(0,n.kq)(" SELECTING WHICH OBJECTS TO LINK TO "),(0,n._)("div",Lt,[Mt,(0,n._)("div",St,[(0,n.kq)(" LOADING PLACEHOLDER "),s.isSearching||null==s.objectModel?((0,n.wg)(),(0,n.iD)("div",xt,[(0,n._)("img",{src:`${e.staticUrl}/NearBeach/images/placeholder/search.svg`,alt:"Searching..."},null,8,Ut)])):(0,n.kq)("v-if",!0),0==s.objectResults.length&&null!=s.objectModel?((0,n.wg)(),(0,n.iD)("div",$t," Sorry - there are no results. ")):(0,n.kq)("v-if",!0),(0,n.kq)(" SEARCH RESULTS "),!s.isSearching&&s.objectResults.length>0&&null!=s.objectModel?((0,n.wg)(),(0,n.iD)("div",Rt,[Et,(0,n.wy)((0,n._)("input",{id:"search_terms",class:"form-control","onUpdate:modelValue":a[1]||(a[1]=e=>s.searchTermModel=e),type:"text"},null,512),[[ye.vModelText,s.searchTermModel]])])):(0,n.kq)("v-if",!0),Bt,(0,n.kq)(" TABLE CONTAINING RESULTS "),!s.isSearching&&s.objectFilteredResults.length>0&&null!=s.objectModel?((0,n.wg)(),(0,n.iD)("table",Tt,[(0,n._)("thead",null,[(0,n._)("tr",null,[(0,n._)("td",null,(0,l.toDisplayString)(s.objectModel)+" Description",1),jt])]),(0,n.kq)(" PROJECTS "),"Project"==s.objectModel?((0,n.wg)(),(0,n.iD)("tbody",Nt,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.objectFilteredResults,(e=>((0,n.wg)(),(0,n.iD)("tr",{key:e.pk},[(0,n._)("td",null,[(0,n._)("div",Zt,[(0,n.wy)((0,n._)("input",{class:"form-check-input",type:"radio",name:"link-option",value:e.pk,id:`radio_project_${e.pk}`,"onUpdate:modelValue":a[2]||(a[2]=e=>s.linkModel=e)},null,8,At),[[ye.vModelRadio,s.linkModel]]),(0,n._)("label",{class:"form-check-label",for:`radio_project_${e.pk}`},(0,l.toDisplayString)(e.fields.project_name),9,Ot)]),Kt,(0,n._)("p",qt," Project "+(0,l.toDisplayString)(e.pk),1)]),(0,n._)("td",null,(0,l.toDisplayString)(e.fields.project_status),1)])))),128))])):(0,n.kq)("v-if",!0),(0,n.kq)(" REQUIREMENTS "),"Requirement"==s.objectModel?((0,n.wg)(),(0,n.iD)("tbody",Pt,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.objectFilteredResults,(e=>((0,n.wg)(),(0,n.iD)("tr",{key:e.pk},[(0,n._)("td",null,[(0,n._)("div",Ft,[(0,n.wy)((0,n._)("input",{class:"form-check-input",type:"radio",name:"link-option",value:e.pk,id:`radio_requirement_${e.pk}`,"onUpdate:modelValue":a[3]||(a[3]=e=>s.linkModel=e)},null,8,Wt),[[ye.vModelRadio,s.linkModel]]),(0,n._)("label",{class:"form-check-label",for:`radio_task_${e.pk}`},(0,l.toDisplayString)(e.fields.requirement_title),9,Vt)]),zt,(0,n._)("p",Ht," Requirement "+(0,l.toDisplayString)(e.pk),1)]),(0,n._)("td",null,(0,l.toDisplayString)(e.fields.requirement_status),1)])))),128))])):(0,n.kq)("v-if",!0),(0,n.kq)(" TASKS "),"Task"==s.objectModel?((0,n.wg)(),(0,n.iD)("tbody",Yt,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.objectFilteredResults,(e=>((0,n.wg)(),(0,n.iD)("tr",{key:e.pk},[(0,n._)("td",null,[(0,n._)("div",Gt,[(0,n.wy)((0,n._)("input",{class:"form-check-input",type:"radio",value:e.pk,id:`radio_task_${e.pk}`,"onUpdate:modelValue":a[4]||(a[4]=e=>s.linkModel=e)},null,8,Jt),[[ye.vModelRadio,s.linkModel]]),(0,n._)("label",{class:"form-check-label",for:`radio_task_${e.pk}`},(0,l.toDisplayString)(e.fields.task_short_description),9,Qt)]),Xt,(0,n._)("p",en," Task "+(0,l.toDisplayString)(e.pk),1)]),(0,n._)("td",null,(0,l.toDisplayString)(e.fields.task_status),1)])))),128))])):(0,n.kq)("v-if",!0)])):(0,n.kq)("v-if",!0)])])]),(0,n._)("div",an,[tn,(0,n._)("button",{type:"button",class:"btn btn-primary",disabled:0==s.linkModel.length,onClick:a[5]||(a[5]=(...e)=>d.saveLinks&&d.saveLinks(...e))}," Save changes ",8,nn)])])])],8,pt)}]]),sn={class:"modal fade",id:"confirmCardArchiveModal",tabindex:"-1","aria-labelledby":"confirmCardArchiveModalLabel","aria-hidden":"true"},dn={class:"modal-dialog modal-lg"},rn={class:"modal-content"},cn=(0,n._)("div",{class:"modal-header"},[(0,n._)("h2",null,"Card Information"),(0,n._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmCardArchiveModalCloseButton"},[(0,n._)("span",{"aria-hidden":"true"})])],-1),un={class:"modal-body"},bn=(0,n._)("div",{class:"alert alert-danger"}," Please note - archiving the card can not be undone. ",-1),mn=(0,n._)("h3",null," Are you sure you want to archive the following card? ",-1),hn={class:"row"},pn={class:"col"},kn=(0,n._)("br",null,null,-1),_n={class:"row"},vn={class:"col"},gn={class:"modal-footer"},fn={name:"ConfirmCardArchive",computed:{...(0,M.Se)({cardId:"getCardId",cardTitle:"getCardTitle",rootUrl:"getRootUrl"})},methods:{archiveCard(){const e=new FormData;e.append("kanban_card_id",this.cardId),this.$store.commit({type:"archiveCard",cardId:this.cardId}),document.getElementById("confirmCardArchiveModalCloseButton").click(),this.axios.post(`${this.rootUrl}kanban_information/archive_kanban_cards/`,e).catch((e=>{}))},goBack(){document.getElementById("confirmCardArchiveModalCloseButton").click(),new L.u_("#cardInformationModal").show()}}},Cn=(0,$.Z)(fn,[["render",function(e,a,t,o,s,d){return(0,n.wg)(),(0,n.iD)("div",sn,[(0,n._)("div",dn,[(0,n._)("div",rn,[cn,(0,n._)("div",un,[bn,mn,(0,n._)("div",hn,[(0,n._)("div",pn,"Card No. - "+(0,l.toDisplayString)(e.cardId),1)]),kn,(0,n._)("div",_n,[(0,n._)("div",vn,"Card Title - "+(0,l.toDisplayString)(e.cardTitle),1)])]),(0,n._)("div",gn,[(0,n._)("button",{type:"button",class:"btn btn-danger",onClick:a[0]||(a[0]=(...e)=>d.archiveCard&&d.archiveCard(...e))}," Yes Archive Card "),(0,n._)("button",{type:"button",class:"btn btn-secondary",onClick:a[1]||(a[1]=(...e)=>d.goBack&&d.goBack(...e))}," No go back ")])])])])}]]);var yn=t(6916),wn=t(624),In=t(1713),Dn=t(6200);const Ln={name:"KanbanInformation",components:{ConfirmFileDeleteVue:t(2551).Z,AddLinkWizard:Dn.Z,AddFolderWizard:In.Z,UploadDocumentWizard:bt.Z,AddUserToCard:R,ArchiveCards:K,BlockedNotesModal:ee,CardInformation:ht,ConfirmCardArchive:Cn,KanbanBoard:Ce,NewKanbanCard:We,NewKanbanLinkWizard:on,NSwitch:yn.Z},props:{columnResults:{type:Array,default:()=>[]},kanbanBoardResults:{type:Array,default:()=>[]},kanbanCardResults:{type:Array,default:()=>[]},kanbanSettings:{type:Object,default:()=>({setting_data:{canDragCards:!0,levels:[]}})},levelResults:{type:Array,default:()=>[]},locationId:{type:Number,default:0},openCardOnLoad:{type:Number,default:0},potentialUserList:{type:Array,default:()=>[]},rootUrl:{type:String,default:"/"},staticUrl:{type:String,default:"/"},theme:{type:String,default:""},userLevel:{type:Number,default:0}},computed:{...(0,M.Se)({cardId:"getCardId"})},watch:{cardId(){this.refreshUserList=!0}},mixins:[wn.Z],data(){return{canDragCards:!0,cardInformation:{},localKanbanCardResults:this.kanbanCardResults,refreshUserList:!1,newCardInfo:[]}},methods:{doubleClickedCard(e){this.cardInformation=e},newCard(e){this.$store.commit({type:"addCard",newCard:e})},resetRefreshUserList(){this.refreshUserList=!1},updateCanDragCards(e){this.$store.dispatch({type:"updateCanDragCards",canDragCards:e})},updateCard(e){this.localKanbanCardResults.forEach(((a,t)=>{a.pk===e.kanban_card_id&&(this.localKanbanCardResults[t].fields.kanban_card_text=e.kanban_card_text,this.localKanbanCardResults[t].fields.kanban_card_description=e.kanban_card_description)}))},updateKanbanSettings(){if(void 0===this.kanbanSettings.setting_data)return;let e=this.kanbanSettings.setting_data.canDragCards;void 0===e&&(e=!0),this.canDragCards=e;let a=this.kanbanSettings.setting_data.levels;void 0===a&&(a=[]);const t=a.map((e=>e.level_id));this.levelResults.filter((e=>-1===t.indexOf(e.pk))).forEach((e=>{a.push({level_id:e.pk,is_collapsed:!1})}));const n=this.levelResults.map((e=>e.pk));a=a.filter((e=>n.indexOf(e.level_id)>=0)),this.$store.commit({type:"initKanbanSettings",canDragCards:e,levels:a})}},async beforeMount(){await this.$store.dispatch("processThemeUpdate",{theme:this.theme})},mounted(){this.updateKanbanSettings(),this.$store.commit({type:"initPayload",kanbanCardResults:this.kanbanCardResults,levelResults:this.levelResults,columnResults:this.columnResults,openCardOnLoad:this.openCardOnLoad}),this.$store.commit({type:"updateUrl",rootUrl:this.rootUrl,staticUrl:this.staticUrl}),this.$store.commit({type:"updateDestination",destination:"kanban_board",locationId:this.locationId}),this.$store.commit({type:"updateLists",columnResults:this.columnResults,levelResults:this.levelResults}),this.$store.commit({type:"updateUserLevel",userLevel:this.userLevel}),this.$store.commit({type:"updateGroupsAndUsers",potentialUserList:this.potentialUserList})}},Mn=(0,$.Z)(Ln,[["render",function(e,a,t,i,r,c){const u=(0,n.up)("n-switch"),b=(0,n.up)("kanban-board"),m=(0,n.up)("add-user-to-card"),h=(0,n.up)("archive-cards"),p=(0,n.up)("blocked-notes-modal"),k=(0,n.up)("confirm-card-archive"),_=(0,n.up)("new-kanban-card"),v=(0,n.up)("card-information"),g=(0,n.up)("upload-document-wizard"),f=(0,n.up)("add-folder-wizard"),C=(0,n.up)("add-link-wizard"),y=(0,n.up)("confirm-file-delete-vue"),w=(0,n.up)("new-kanban-link-wizard"),I=(0,n.up)("n-config-provider");return(0,n.wg)(),(0,n.j4)(I,{theme:e.getTheme(t.theme)},{default:(0,n.w5)((()=>[(0,n._)("div",null,[(0,n._)("h1",o,(0,l.toDisplayString)(t.kanbanBoardResults[0].fields.kanban_board_name),1),(0,n._)("div",s,[t.userLevel>=3?((0,n.wg)(),(0,n.iD)("a",{key:0,href:`${t.rootUrl}kanban_information/${t.kanbanBoardResults[0].pk}/edit_board/`}," Edit Kanban ",8,d)):(0,n.kq)("v-if",!0),"Closed"!==t.kanbanBoardResults[0].fields.kanban_board_status&&t.userLevel>=2?((0,n.wg)(),(0,n.j4)(u,{key:1,value:r.canDragCards,"onUpdate:value":[a[0]||(a[0]=e=>r.canDragCards=e),c.updateCanDragCards]},{checked:(0,n.w5)((()=>[(0,n.Uk)(" Can Drag Cards ")])),unchecked:(0,n.w5)((()=>[(0,n.Uk)(" Card Position Locked ")])),_:1},8,["value","onUpdate:value"])):(0,n.kq)("v-if",!0)]),(0,n.kq)(" Rendering the Kanban Container "),(0,n.Wm)(b,{"kanban-board-results":t.kanbanBoardResults,"new-card-info":r.newCardInfo,onDouble_clicked_card:a[1]||(a[1]=e=>c.doubleClickedCard(e))},null,8,["kanban-board-results","new-card-info"]),(0,n.kq)(" MODALS "),(0,n.Wm)(m,{destination:"kanban_card","location-id":e.cardId,"refresh-user-list":r.refreshUserList,onReset_refresh_user_list:c.resetRefreshUserList},null,8,["location-id","refresh-user-list","onReset_refresh_user_list"]),(0,n.Wm)(h),(0,n.Wm)(p),(0,n.Wm)(k,{"card-information":r.cardInformation},null,8,["card-information"]),(0,n.Wm)(_,{"kanban-card-results":t.kanbanCardResults,"column-results":t.columnResults,"level-results":t.levelResults,"kanban-board-results":t.kanbanBoardResults,onNew_card:a[2]||(a[2]=e=>c.newCard(e))},null,8,["kanban-card-results","column-results","level-results","kanban-board-results"]),(0,n.Wm)(v,{"card-information":r.cardInformation,onUpdate_card:a[3]||(a[3]=e=>c.updateCard(e))},null,8,["card-information"]),(0,n.Wm)(g,{"override-destination":"kanban_card","override-location-id":e.cardId},null,8,["override-location-id"]),(0,n.Wm)(f,{destination:"kanban_card","location-id":t.locationId},null,8,["location-id"]),(0,n.Wm)(C,{destination:"kanban_card","location-id":t.locationId},null,8,["location-id"]),(0,n.kq)(" CONFIRM DOCUMENT DELETE "),(0,n.Wm)(y),(0,n.Wm)(w,{"location-id":t.locationId,"column-results":t.columnResults,"level-results":t.levelResults,onNew_card:a[4]||(a[4]=e=>c.newCard(e))},null,8,["location-id","column-results","level-results"])])])),_:1},8,["theme"])}]])},3058:(e,a,t)=>{t.d(a,{Z:()=>l});var n=t(3138);const l={methods:{showErrorModal(e,a,t){const l=document.getElementById("loadingModal");if(null===l)return;new n.u_(l).hide();const o=document.getElementById("errorModalContent");if(void 0===o)return;if(o.innerHTML=`<strong>HTML ISSUE:</strong> We could not save the new ${a}-${t}<hr>${e}`,null===document.getElementById("errorModal"))return;const s=new n.u_(s);s.show()},showValidationErrorModal(){document.getElementById("errorModalContent").innerHTML="<strong>FORM ISSUE:</strong> Sorry, but can you please fill out the form completely.",new n.u_(document.getElementById("errorModal")).show()}}}},624:(e,a,t)=>{t.d(a,{Z:()=>l});var n=t(7449);const l={data:()=>({darkTheme:n.$}),methods:{getTheme:e=>"dark"===e?n.$:null}}},5808:(e,a,t)=>{t.d(a,{Z:()=>S});var n=t(3985),l=t(5555),o=t(1826),s=t(6443),d=t(1327),i=t(8521),r=t(1056),c=t(4324),u=t(9672),b=t(9867),m=t(1239),h=t(5004),p=t(1321),k=t(1216),_=t(5550),v=t(7702),g=t(7903),f=t(2606),C=t(3843),y=t(2393),w=t(3360),I=t(9714),D=t(1323),L=t(2610),M=t(5968);const S={data:()=>({icons:{arrowUp:n.Z,bugIcon:l.Z,bxBriefcase:o.Z,cardChecklist:s.Z,clipboardIcon:d.Z,documentPdf:i.Z,documentText:r.Z,folderIcon:c.Z,groupPresentation:u.Z,imageIcon:b.Z,infoCircle:m.Z,linkIcon:h.Z,linkIcon2:p.Z,linkOut:k.Z,mailIcon:_.Z,microsoftExcel:v.Z,microsoftPowerpoint:g.Z,microsoftWord:f.Z,noteAdd:C.Z,objectStorage:y.Z,passwordIcon:w.Z,trashCan:I.Z,userIcon:D.Z,usersIcon:L.Z,xCircle:M.Z}})}},2299:(e,a,t)=>{t.d(a,{Z:()=>s});var n=t(1257),l=t(989),o=t(3058);const s={computed:{...(0,l.Se)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl"})},mixins:[o.Z],methods:{uploadImage(e,a){const t=new FormData;t.set("document",e.blob(),e.filename()),t.set("document_description",e.filename());const l={onUploadProgress:e=>{parseFloat(e.loaded),parseFloat(e.total)}};return n.Z.post(`${this.rootUrl}documentation/${this.destination}/${this.locationId}/upload/`,t,l).then((e=>`/private/${e.data[0].document_key_id}`)).catch((e=>{this.showErrorModal(e,"Upload Image","")}))},newObjectUploadImage(e,a){const t=new FormData;t.set("document",e.blob(),e.filename()),t.set("document_description",e.filename()),t.set("uuid",this.uuid);const l={onUploadProgress:e=>{parseFloat(e.loaded),parseFloat(e.total)}};return n.Z.post(`${this.rootUrl}documentation/new_object_upload/`,t,l).then((e=>`/private/${e.data[0].document_key_id}`)).catch((e=>{this.showErrorModal(e,"Upload Image","")}))}}}}}]);